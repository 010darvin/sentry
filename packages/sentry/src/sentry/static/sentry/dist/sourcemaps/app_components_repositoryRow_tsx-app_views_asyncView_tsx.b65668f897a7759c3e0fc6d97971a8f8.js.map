{"version":3,"file":"chunks/app_components_repositoryRow_tsx-app_views_asyncView_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/actionCreators/integrations.tsx","webpack:///./app/components/repositoryEditForm.tsx","webpack:///./app/components/repositoryRow.tsx","webpack:///./app/views/asyncView.tsx"],"sourcesContent":["import {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n  clearIndicators,\n} from 'sentry/actionCreators/indicator';\nimport {Client} from 'sentry/api';\nimport {t, tct} from 'sentry/locale';\nimport {Integration, Repository} from 'sentry/types';\n\nconst api = new Client();\n\n/**\n * Removes an integration from a project.\n *\n * @param {String} orgId Organization Slug\n * @param {String} projectId Project Slug\n * @param {Object} integration The organization integration to remove\n */\nexport function removeIntegrationFromProject(\n  orgId: string,\n  projectId: string,\n  integration: Integration\n) {\n  const endpoint = `/projects/${orgId}/${projectId}/integrations/${integration.id}/`;\n  addLoadingMessage();\n\n  return api.requestPromise(endpoint, {method: 'DELETE'}).then(\n    () => {\n      addSuccessMessage(t('Disabled %s for %s', integration.name, projectId));\n    },\n    () => {\n      addErrorMessage(t('Failed to disable %s for %s', integration.name, projectId));\n    }\n  );\n}\n\n/**\n * Add an integration to a project\n *\n * @param {String} orgId Organization Slug\n * @param {String} projectId Project Slug\n * @param {Object} integration The organization integration to add\n */\nexport function addIntegrationToProject(\n  orgId: string,\n  projectId: string,\n  integration: Integration\n) {\n  const endpoint = `/projects/${orgId}/${projectId}/integrations/${integration.id}/`;\n  addLoadingMessage();\n\n  return api.requestPromise(endpoint, {method: 'PUT'}).then(\n    () => {\n      addSuccessMessage(t('Enabled %s for %s', integration.name, projectId));\n    },\n    () => {\n      addErrorMessage(t('Failed to enabled %s for %s', integration.name, projectId));\n    }\n  );\n}\n\n/**\n * Delete a respository\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {String} repositoryId Repository ID\n */\nexport function deleteRepository(client: Client, orgId: string, repositoryId: string) {\n  addLoadingMessage();\n  const promise = client.requestPromise(\n    `/organizations/${orgId}/repos/${repositoryId}/`,\n    {\n      method: 'DELETE',\n    }\n  );\n  promise.then(\n    () => clearIndicators(),\n    () => addErrorMessage(t('Unable to delete repository.'))\n  );\n  return promise;\n}\n\n/**\n * Cancel the deletion of a respository\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {String} repositoryId Repository ID\n */\nexport function cancelDeleteRepository(\n  client: Client,\n  orgId: string,\n  repositoryId: string\n) {\n  addLoadingMessage();\n  const promise = client.requestPromise(\n    `/organizations/${orgId}/repos/${repositoryId}/`,\n    {\n      method: 'PUT',\n      data: {status: 'visible'},\n    }\n  );\n  promise.then(\n    () => clearIndicators(),\n    () => addErrorMessage(t('Unable to cancel deletion.'))\n  );\n  return promise;\n}\n\nfunction applyRepositoryAddComplete(promise: Promise<Repository>) {\n  promise.then(\n    (repo: Repository) => {\n      const message = tct('[repo] has been successfully added.', {\n        repo: repo.name,\n      });\n      addSuccessMessage(message);\n    },\n    errorData => {\n      const text = errorData.responseJSON.errors\n        ? errorData.responseJSON.errors.__all__\n        : t('Unable to add repository.');\n      addErrorMessage(text);\n    }\n  );\n  return promise;\n}\n\n/**\n * Migrate a repository to a new integration.\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {String} repositoryId Repository ID\n * @param {Object} integration Integration provider data.\n */\nexport function migrateRepository(\n  client: Client,\n  orgId: string,\n  repositoryId: string,\n  integration: Integration\n) {\n  const data = {integrationId: integration.id};\n  addLoadingMessage();\n  const promise = client.requestPromise(\n    `/organizations/${orgId}/repos/${repositoryId}/`,\n    {\n      data,\n      method: 'PUT',\n    }\n  );\n  return applyRepositoryAddComplete(promise);\n}\n\n/**\n * Add a repository\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {String} name Repository identifier/name to add\n * @param {Object} integration Integration provider data.\n */\nexport function addRepository(\n  client: Client,\n  orgId: string,\n  name: string,\n  integration: Integration\n) {\n  const data = {\n    installation: integration.id,\n    identifier: name,\n    provider: `integrations:${integration.provider.key}`,\n  };\n  addLoadingMessage();\n  const promise = client.requestPromise(`/organizations/${orgId}/repos/`, {\n    method: 'POST',\n    data,\n  });\n  return applyRepositoryAddComplete(promise);\n}\n","import {Component} from 'react';\n\nimport {FieldFromConfig} from 'sentry/components/forms';\nimport Form from 'sentry/components/forms/form';\nimport {Field} from 'sentry/components/forms/type';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {t, tct} from 'sentry/locale';\nimport {Repository} from 'sentry/types';\n\nimport Alert from './alert';\n\ntype Props = Pick<Form['props'], 'onSubmitSuccess' | 'onCancel'> & {\n  closeModal: () => void;\n  onSubmitSuccess: (data: any) => void;\n  orgSlug: string;\n  repository: Repository;\n};\n\nexport default class RepositoryEditForm extends Component<Props> {\n  get initialData() {\n    const {repository} = this.props;\n\n    return {\n      name: repository.name,\n      url: repository.url || '',\n    };\n  }\n\n  get formFields(): Field[] {\n    const fields: any[] = [\n      {\n        name: 'name',\n        type: 'string',\n        required: true,\n        label: t('Name of your repository.'),\n      },\n      {\n        name: 'url',\n        type: 'string',\n        required: false,\n        label: t('Full URL to your repository.'),\n        placeholder: t('https://github.com/my-org/my-repo/'),\n      },\n    ];\n    return fields;\n  }\n\n  render() {\n    const {onCancel, orgSlug, repository} = this.props;\n    const endpoint = `/organizations/${orgSlug}/repos/${repository.id}/`;\n    return (\n      <Form\n        initialData={this.initialData}\n        onSubmitSuccess={data => {\n          this.props.onSubmitSuccess(data);\n          this.props.closeModal();\n        }}\n        apiEndpoint={endpoint}\n        apiMethod=\"PUT\"\n        onCancel={onCancel}\n      >\n        <Alert type=\"warning\" showIcon>\n          {tct(\n            'Changing the [name:repo name] may have consequences if it no longer matches the repo name used when [link:sending commits with releases].',\n            {\n              link: (\n                <ExternalLink href=\"https://docs.sentry.io/product/cli/releases/#sentry-cli-commit-integration\" />\n              ),\n              name: <strong>repo name</strong>,\n            }\n          )}\n        </Alert>\n        {this.formFields.map(field => (\n          <FieldFromConfig\n            key={field.name}\n            field={field}\n            inline={false}\n            stacked\n            flexibleControlStateSize\n          />\n        ))}\n      </Form>\n    );\n  }\n}\n","import {Fragment} from 'react';\nimport styled from '@emotion/styled';\n\nimport {\n  cancelDeleteRepository,\n  deleteRepository,\n} from 'sentry/actionCreators/integrations';\nimport {openModal} from 'sentry/actionCreators/modal';\nimport {Client} from 'sentry/api';\nimport Access from 'sentry/components/acl/access';\nimport Button from 'sentry/components/button';\nimport Confirm from 'sentry/components/confirm';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {PanelItem} from 'sentry/components/panels';\nimport RepositoryEditForm from 'sentry/components/repositoryEditForm';\nimport Tooltip from 'sentry/components/tooltip';\nimport {IconDelete, IconEdit} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Organization, Repository, RepositoryStatus} from 'sentry/types';\nimport withOrganization from 'sentry/utils/withOrganization';\n\ntype Props = {\n  api: Client;\n  orgId: string;\n  organization: Organization;\n  repository: Repository;\n  onRepositoryChange?: (data: {id: string; status: RepositoryStatus}) => void;\n  showProvider?: boolean;\n};\n\nfunction getStatusLabel(repo: Repository) {\n  switch (repo.status) {\n    case RepositoryStatus.PENDING_DELETION:\n      return 'Deletion Queued';\n    case RepositoryStatus.DELETION_IN_PROGRESS:\n      return 'Deletion in Progress';\n    case RepositoryStatus.DISABLED:\n      return 'Disabled';\n    case RepositoryStatus.HIDDEN:\n      return 'Disabled';\n    default:\n      return null;\n  }\n}\n\nfunction RepositoryRow({\n  api,\n  repository,\n  onRepositoryChange,\n  organization,\n  orgId,\n  showProvider = false,\n}: Props) {\n  const isCustomRepo =\n    organization.features.includes('integrations-custom-scm') &&\n    repository.provider.id === 'integrations:custom_scm';\n\n  const isActive = repository.status === RepositoryStatus.ACTIVE;\n\n  const cancelDelete = () =>\n    cancelDeleteRepository(api, orgId, repository.id).then(\n      data => {\n        if (onRepositoryChange) {\n          onRepositoryChange(data);\n        }\n      },\n      () => {}\n    );\n\n  const deleteRepo = () =>\n    deleteRepository(api, orgId, repository.id).then(\n      data => {\n        if (onRepositoryChange) {\n          onRepositoryChange(data);\n        }\n      },\n      () => {}\n    );\n\n  const handleEditRepo = (data: Repository) => {\n    onRepositoryChange?.(data);\n  };\n\n  const renderDeleteButton = (hasAccess: boolean) => (\n    <Tooltip\n      title={t(\n        'You must be an organization owner, manager or admin to remove a repository.'\n      )}\n      disabled={hasAccess}\n    >\n      <Confirm\n        disabled={\n          !hasAccess || (!isActive && repository.status !== RepositoryStatus.DISABLED)\n        }\n        onConfirm={deleteRepo}\n        message={t(\n          'Are you sure you want to remove this repository? All associated commit data will be removed in addition to the repository.'\n        )}\n      >\n        <StyledButton\n          size=\"xs\"\n          icon={<IconDelete size=\"xs\" />}\n          aria-label={t('delete')}\n          disabled={!hasAccess}\n        />\n      </Confirm>\n    </Tooltip>\n  );\n\n  const triggerModal = () =>\n    openModal(({Body, Header, closeModal}) => (\n      <Fragment>\n        <Header closeButton>{t('Edit Repository')}</Header>\n        <Body>\n          <RepositoryEditForm\n            orgSlug={orgId}\n            repository={repository}\n            onSubmitSuccess={handleEditRepo}\n            closeModal={closeModal}\n            onCancel={closeModal}\n          />\n        </Body>\n      </Fragment>\n    ));\n\n  return (\n    <Access access={['org:integrations']}>\n      {({hasAccess}) => (\n        <StyledPanelItem status={repository.status}>\n          <RepositoryTitleAndUrl>\n            <RepositoryTitle>\n              <strong>{repository.name}</strong>\n              {!isActive && <small> &mdash; {getStatusLabel(repository)}</small>}\n              {repository.status === RepositoryStatus.PENDING_DELETION && (\n                <StyledButton\n                  size=\"xs\"\n                  onClick={cancelDelete}\n                  disabled={!hasAccess}\n                  data-test-id=\"repo-cancel\"\n                >\n                  {t('Cancel')}\n                </StyledButton>\n              )}\n            </RepositoryTitle>\n            <div>\n              {showProvider && <small>{repository.provider.name}</small>}\n              {showProvider && repository.url && <span>&nbsp;&mdash;&nbsp;</span>}\n              {repository.url && (\n                <small>\n                  <ExternalLink href={repository.url}>\n                    {repository.url.replace('https://', '')}\n                  </ExternalLink>\n                </small>\n              )}\n            </div>\n          </RepositoryTitleAndUrl>\n          {isCustomRepo ? (\n            <EditAndDelete>\n              <StyledButton\n                size=\"xs\"\n                icon={<IconEdit size=\"xs\" />}\n                aria-label={t('edit')}\n                disabled={\n                  !hasAccess ||\n                  (!isActive && repository.status !== RepositoryStatus.DISABLED)\n                }\n                onClick={triggerModal}\n              />\n              {renderDeleteButton(hasAccess)}\n            </EditAndDelete>\n          ) : (\n            renderDeleteButton(hasAccess)\n          )}\n        </StyledPanelItem>\n      )}\n    </Access>\n  );\n}\n\nconst StyledPanelItem = styled(PanelItem)<{status: RepositoryStatus}>`\n  /* shorter top padding because of title lineheight */\n  padding: ${space(1)} ${space(2)} ${space(2)};\n  justify-content: space-between;\n  align-items: center;\n  flex: 1;\n\n  ${p =>\n    p.status === RepositoryStatus.DISABLED &&\n    `\n    filter: grayscale(1);\n    opacity: 0.4;\n  `};\n\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst StyledButton = styled(Button)`\n  margin-left: ${space(1)};\n`;\n\nconst RepositoryTitleAndUrl = styled('div')`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst EditAndDelete = styled('div')`\n  display: flex;\n  margin-left: ${space(1)};\n`;\n\nconst RepositoryTitle = styled('div')`\n  /* accommodate cancel button height */\n  line-height: 26px;\n`;\n\nexport default withOrganization(RepositoryRow);\n","import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n"],"names":["addErrorMessage","addLoadingMessage","addSuccessMessage","clearIndicators","Client","t","tct","api","removeIntegrationFromProject","orgId","projectId","integration","endpoint","id","requestPromise","method","then","name","addIntegrationToProject","deleteRepository","client","repositoryId","promise","cancelDeleteRepository","data","status","applyRepositoryAddComplete","repo","message","errorData","text","responseJSON","errors","__all__","migrateRepository","integrationId","addRepository","installation","identifier","provider","key","Component","FieldFromConfig","Form","ExternalLink","Alert","RepositoryEditForm","initialData","repository","props","url","formFields","fields","type","required","label","placeholder","render","onCancel","orgSlug","onSubmitSuccess","closeModal","link","map","field","Fragment","openModal","Access","Button","Confirm","PanelItem","Tooltip","IconDelete","IconEdit","space","RepositoryStatus","withOrganization","getStatusLabel","PENDING_DELETION","DELETION_IN_PROGRESS","DISABLED","HIDDEN","RepositoryRow","onRepositoryChange","organization","showProvider","isCustomRepo","features","includes","isActive","ACTIVE","cancelDelete","deleteRepo","handleEditRepo","renderDeleteButton","hasAccess","triggerModal","Body","Header","replace","StyledPanelItem","p","StyledButton","RepositoryTitleAndUrl","EditAndDelete","RepositoryTitle","AsyncComponent","SentryDocumentTitle","AsyncView","getTitle","renderComponent"],"sourceRoot":""}