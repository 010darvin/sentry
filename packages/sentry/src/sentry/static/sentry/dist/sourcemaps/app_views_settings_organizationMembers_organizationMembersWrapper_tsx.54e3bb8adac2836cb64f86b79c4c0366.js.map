{"version":3,"file":"chunks/app_views_settings_organizationMembers_organizationMembersWrapper_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/utils/routeTitle.tsx","webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/organizationMembers/organizationMembersWrapper.tsx"],"sourcesContent":["function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {cloneElement, Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport {openInviteMembersModal} from 'sentry/actionCreators/modal';\nimport FeatureDisabled from 'sentry/components/acl/featureDisabled';\nimport Button from 'sentry/components/button';\nimport HookOrDefault from 'sentry/components/hookOrDefault';\nimport {Hovercard} from 'sentry/components/hovercard';\nimport {IconMail} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport {Member, Organization} from 'sentry/types';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport AsyncView from 'sentry/views/asyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\n\ntype Props = {\n  organization: Organization;\n  children?: any;\n} & RouteComponentProps<{orgId: string}, {}>;\n\ntype State = AsyncView['state'] & {\n  inviteRequests: Member[];\n};\n\nconst InviteMembersButtonHook = HookOrDefault({\n  hookName: 'member-invite-button:customization',\n  defaultComponent: ({children, organization, onTriggerModal}) =>\n    children({\n      disabled: !organization.features.includes('invite-members'),\n      onTriggerModal,\n    }),\n});\n\nclass OrganizationMembersWrapper extends AsyncView<Props, State> {\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {orgId} = this.props.params;\n\n    return [\n      ['inviteRequests', `/organizations/${orgId}/invite-requests/`],\n      ['requestList', `/organizations/${orgId}/access-requests/`],\n    ];\n  }\n\n  getTitle() {\n    const {orgId} = this.props.params;\n    return routeTitleGen(t('Members'), orgId, false);\n  }\n\n  get onRequestsTab() {\n    return location.pathname.includes('/requests/');\n  }\n\n  get hasWriteAccess() {\n    const {organization} = this.props;\n    if (!organization || !organization.access) {\n      return false;\n    }\n    return organization.access.includes('member:write');\n  }\n\n  get showInviteRequests() {\n    return this.hasWriteAccess;\n  }\n\n  get showNavTabs() {\n    const {requestList} = this.state;\n\n    // show the requests tab if there are pending team requests,\n    // or if the user has access to approve or deny invite requests\n    return (requestList && requestList.length > 0) || this.showInviteRequests;\n  }\n\n  get requestCount() {\n    const {requestList, inviteRequests} = this.state;\n    let count = requestList.length;\n\n    // if the user can't see the invite requests panel,\n    // exclude those requests from the total count\n    if (this.showInviteRequests) {\n      count += inviteRequests.length;\n    }\n    return count ? count.toString() : null;\n  }\n\n  removeAccessRequest = (id: string) =>\n    this.setState(state => ({\n      requestList: state.requestList.filter(request => request.id !== id),\n    }));\n\n  removeInviteRequest = (id: string) =>\n    this.setState(state => ({\n      inviteRequests: state.inviteRequests.filter(request => request.id !== id),\n    }));\n\n  updateInviteRequest = (id: string, data: Partial<Member>) =>\n    this.setState(state => {\n      const inviteRequests = [...state.inviteRequests];\n      const inviteIndex = inviteRequests.findIndex(request => request.id === id);\n\n      inviteRequests[inviteIndex] = {...inviteRequests[inviteIndex], ...data};\n\n      return {inviteRequests};\n    });\n\n  renderBody() {\n    const {children, organization} = this.props;\n    const {requestList, inviteRequests} = this.state;\n\n    const action = (\n      <InviteMembersButtonHook\n        organization={organization}\n        onTriggerModal={() =>\n          openInviteMembersModal({\n            onClose: () => {\n              this.fetchData();\n            },\n            source: 'members_settings',\n          })\n        }\n      >\n        {renderInviteMembersButton}\n      </InviteMembersButtonHook>\n    );\n\n    return (\n      <Fragment>\n        <SettingsPageHeader title=\"Members\" action={action} />\n        {children &&\n          cloneElement(children, {\n            requestList,\n            inviteRequests,\n            onRemoveInviteRequest: this.removeInviteRequest,\n            onUpdateInviteRequest: this.updateInviteRequest,\n            onRemoveAccessRequest: this.removeAccessRequest,\n            showInviteRequests: this.showInviteRequests,\n          })}\n      </Fragment>\n    );\n  }\n}\n\nfunction renderInviteMembersButton({\n  disabled,\n  onTriggerModal,\n}: {\n  onTriggerModal: () => void;\n  disabled?: boolean;\n}) {\n  const action = (\n    <Button\n      priority=\"primary\"\n      size=\"sm\"\n      onClick={onTriggerModal}\n      data-test-id=\"email-invite\"\n      icon={<IconMail />}\n      disabled={disabled}\n    >\n      {t('Invite Members')}\n    </Button>\n  );\n\n  return disabled ? (\n    <Hovercard\n      body={\n        <FeatureDisabled\n          featureName={t('Invite Members')}\n          features={['organizations:invite-members']}\n          hideHelpToggle\n        />\n      }\n    >\n      {action}\n    </Hovercard>\n  ) : (\n    action\n  );\n}\n\nexport default withOrganization(OrganizationMembersWrapper);\n"],"names":["routeTitleGen","routeName","orgSlug","withSentry","projectSlug","tmplBase","tmpl","AsyncComponent","SentryDocumentTitle","AsyncView","getTitle","render","renderComponent","cloneElement","Fragment","openInviteMembersModal","FeatureDisabled","Button","HookOrDefault","Hovercard","IconMail","t","withOrganization","SettingsPageHeader","InviteMembersButtonHook","hookName","defaultComponent","children","organization","onTriggerModal","disabled","features","includes","OrganizationMembersWrapper","id","setState","state","requestList","filter","request","inviteRequests","data","inviteIndex","findIndex","getEndpoints","orgId","props","params","onRequestsTab","location","pathname","hasWriteAccess","access","showInviteRequests","showNavTabs","length","requestCount","count","toString","renderBody","action","onClose","fetchData","source","renderInviteMembersButton","onRemoveInviteRequest","removeInviteRequest","onUpdateInviteRequest","updateInviteRequest","onRemoveAccessRequest","removeAccessRequest"],"sourceRoot":""}