{"version":3,"file":"chunks/app_views_settings_account_apiApplications_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/account/apiApplications/index.tsx","webpack:///./app/views/settings/account/apiApplications/row.tsx"],"sourcesContent":["import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {RouteComponentProps} from 'react-router';\n\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n} from 'sentry/actionCreators/indicator';\nimport Button from 'sentry/components/button';\nimport {Panel, PanelBody, PanelHeader} from 'sentry/components/panels';\nimport {IconAdd} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport {ApiApplication} from 'sentry/types';\nimport AsyncView from 'sentry/views/asyncView';\nimport Row from 'sentry/views/settings/account/apiApplications/row';\nimport EmptyMessage from 'sentry/views/settings/components/emptyMessage';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\n\nconst ROUTE_PREFIX = '/settings/account/api/';\n\ntype Props = RouteComponentProps<{}, {}>;\ntype State = {\n  appList: ApiApplication[];\n} & AsyncView['state'];\n\nclass ApiApplications extends AsyncView<Props, State> {\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    return [['appList', '/api-applications/']];\n  }\n\n  getTitle() {\n    return t('API Applications');\n  }\n\n  handleCreateApplication = async () => {\n    addLoadingMessage();\n\n    try {\n      const app = await this.api.requestPromise('/api-applications/', {\n        method: 'POST',\n      });\n\n      addSuccessMessage(t('Created a new API Application'));\n      this.props.router.push(`${ROUTE_PREFIX}applications/${app.id}/`);\n    } catch (_err) {\n      addErrorMessage(t('Unable to remove application. Please try again.'));\n    }\n  };\n\n  handleRemoveApplication = (app: ApiApplication) => {\n    this.setState({\n      appList: this.state.appList.filter(a => a.id !== app.id),\n    });\n  };\n\n  renderBody() {\n    const action = (\n      <Button\n        priority=\"primary\"\n        size=\"sm\"\n        onClick={this.handleCreateApplication}\n        icon={<IconAdd size=\"xs\" isCircled />}\n      >\n        {t('Create New Application')}\n      </Button>\n    );\n\n    const isEmpty = this.state.appList.length === 0;\n\n    return (\n      <div>\n        <SettingsPageHeader title=\"API Applications\" action={action} />\n\n        <Panel>\n          <PanelHeader>{t('Application Name')}</PanelHeader>\n\n          <PanelBody>\n            {!isEmpty ? (\n              this.state.appList.map(app => (\n                <Row\n                  api={this.api}\n                  key={app.id}\n                  app={app}\n                  onRemove={this.handleRemoveApplication}\n                />\n              ))\n            ) : (\n              <EmptyMessage>\n                {t(\"You haven't created any applications yet.\")}\n              </EmptyMessage>\n            )}\n          </PanelBody>\n        </Panel>\n      </div>\n    );\n  }\n}\n\nexport default ApiApplications;\n","import {Component} from 'react';\nimport styled from '@emotion/styled';\n\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  clearIndicators,\n} from 'sentry/actionCreators/indicator';\nimport {Client} from 'sentry/api';\nimport Button from 'sentry/components/button';\nimport Link from 'sentry/components/links/link';\nimport {PanelItem} from 'sentry/components/panels';\nimport {IconDelete} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {ApiApplication} from 'sentry/types';\nimport getDynamicText from 'sentry/utils/getDynamicText';\n\nconst ROUTE_PREFIX = '/settings/account/api/';\n\ntype Props = {\n  api: Client;\n  app: ApiApplication;\n  onRemove: (app: ApiApplication) => void;\n};\n\ntype State = {\n  loading: boolean;\n};\n\nclass Row extends Component<Props, State> {\n  state: State = {\n    loading: false,\n  };\n\n  handleRemove = () => {\n    if (this.state.loading) {\n      return;\n    }\n\n    const {api, app, onRemove} = this.props;\n\n    this.setState(\n      {\n        loading: true,\n      },\n      async () => {\n        addLoadingMessage();\n\n        try {\n          await api.requestPromise(`/api-applications/${app.id}/`, {\n            method: 'DELETE',\n          });\n\n          clearIndicators();\n          onRemove(app);\n        } catch (_err) {\n          addErrorMessage(t('Unable to remove application. Please try again.'));\n        }\n      }\n    );\n  };\n\n  render() {\n    const {app} = this.props;\n\n    return (\n      <StyledPanelItem>\n        <ApplicationNameWrapper>\n          <ApplicationName to={`${ROUTE_PREFIX}applications/${app.id}/`}>\n            {getDynamicText({value: app.name, fixed: 'CI_APPLICATION_NAME'})}\n          </ApplicationName>\n          <ClientId>\n            {getDynamicText({value: app.clientID, fixed: 'CI_CLIENT_ID'})}\n          </ClientId>\n        </ApplicationNameWrapper>\n\n        <Button\n          aria-label=\"Remove\"\n          onClick={this.handleRemove}\n          disabled={this.state.loading}\n          icon={<IconDelete />}\n        />\n      </StyledPanelItem>\n    );\n  }\n}\n\nconst StyledPanelItem = styled(PanelItem)`\n  padding: ${space(2)};\n  align-items: center;\n`;\n\nconst ApplicationNameWrapper = styled('div')`\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  margin-right: ${space(1)};\n`;\n\nconst ApplicationName = styled(Link)`\n  margin-bottom: ${space(1)};\n`;\n\nconst ClientId = styled('div')`\n  color: ${p => p.theme.subText};\n  font-size: ${p => p.theme.fontSizeSmall};\n`;\n\nexport default Row;\n"],"names":["AsyncComponent","SentryDocumentTitle","AsyncView","getTitle","render","renderComponent","addErrorMessage","addLoadingMessage","addSuccessMessage","Button","Panel","PanelBody","PanelHeader","IconAdd","t","Row","EmptyMessage","SettingsPageHeader","ROUTE_PREFIX","ApiApplications","app","api","requestPromise","method","props","router","push","id","_err","setState","appList","state","filter","a","getEndpoints","renderBody","action","handleCreateApplication","isEmpty","length","map","handleRemoveApplication","Component","clearIndicators","Link","PanelItem","IconDelete","space","getDynamicText","loading","onRemove","value","name","fixed","clientID","handleRemove","StyledPanelItem","ApplicationNameWrapper","ApplicationName","ClientId","p","theme","subText","fontSizeSmall"],"sourceRoot":""}