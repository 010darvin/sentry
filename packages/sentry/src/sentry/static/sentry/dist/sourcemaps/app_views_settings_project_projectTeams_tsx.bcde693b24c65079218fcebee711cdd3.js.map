{"version":3,"file":"chunks/app_views_settings_project_projectTeams_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/utils/routeTitle.tsx","webpack:///./app/views/settings/project/projectTeams.tsx"],"sourcesContent":["function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import {RouteComponentProps} from 'react-router';\nimport {css} from '@emotion/react';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage} from 'sentry/actionCreators/indicator';\nimport {openCreateTeamModal} from 'sentry/actionCreators/modal';\nimport {addTeamToProject, removeTeamFromProject} from 'sentry/actionCreators/projects';\nimport Link from 'sentry/components/links/link';\nimport Tooltip from 'sentry/components/tooltip';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Organization, Project, Team} from 'sentry/types';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport AsyncView from 'sentry/views/asyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport TeamSelect from 'sentry/views/settings/components/teamSelect';\n\ntype Props = {\n  organization: Organization;\n  project: Project;\n} & RouteComponentProps<{orgId: string; projectId: string}, {}>;\n\ntype State = {\n  projectTeams: null | Team[];\n} & AsyncView['state'];\n\nclass ProjectTeams extends AsyncView<Props, State> {\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {orgId, projectId} = this.props.params;\n    return [['projectTeams', `/projects/${orgId}/${projectId}/teams/`]];\n  }\n\n  getTitle() {\n    const {projectId} = this.props.params;\n    return routeTitleGen(t('Project Teams'), projectId, false);\n  }\n\n  canCreateTeam = () => {\n    const {organization} = this.props;\n    const access = new Set(organization.access);\n    return (\n      access.has('org:write') && access.has('team:write') && access.has('project:write')\n    );\n  };\n\n  handleRemove = (teamSlug: Team['slug']) => {\n    if (this.state.loading) {\n      return;\n    }\n\n    const {orgId, projectId} = this.props.params;\n\n    removeTeamFromProject(this.api, orgId, projectId, teamSlug)\n      .then(() => this.handleRemovedTeam(teamSlug))\n      .catch(() => {\n        addErrorMessage(t('Could not remove the %s team', teamSlug));\n        this.setState({loading: false});\n      });\n  };\n\n  handleRemovedTeam = (teamSlug: Team['slug']) => {\n    this.setState(prevState => ({\n      projectTeams: [\n        ...(prevState.projectTeams || []).filter(team => team.slug !== teamSlug),\n      ],\n    }));\n  };\n\n  handleAddedTeam = (team: Team) => {\n    this.setState(prevState => ({\n      projectTeams: [...(prevState.projectTeams || []), team],\n    }));\n  };\n\n  handleAdd = (team: Team) => {\n    if (this.state.loading) {\n      return;\n    }\n    const {orgId, projectId} = this.props.params;\n\n    addTeamToProject(this.api, orgId, projectId, team).then(\n      () => {\n        this.handleAddedTeam(team);\n      },\n      () => {\n        this.setState({\n          error: true,\n          loading: false,\n        });\n      }\n    );\n  };\n\n  handleCreateTeam = (e: React.MouseEvent) => {\n    const {project, organization} = this.props;\n\n    if (!this.canCreateTeam()) {\n      return;\n    }\n\n    e.stopPropagation();\n    e.preventDefault();\n\n    openCreateTeamModal({\n      project,\n      organization,\n      onClose: data => {\n        addTeamToProject(this.api, organization.slug, project.slug, data).then(\n          this.remountComponent,\n          this.remountComponent\n        );\n      },\n    });\n  };\n\n  renderBody() {\n    const {params, organization} = this.props;\n\n    const canCreateTeam = this.canCreateTeam();\n    const hasAccess = organization.access.includes('project:write');\n    const confirmRemove = t(\n      'This is the last team with access to this project. Removing it will mean ' +\n        'only organization owners and managers will be able to access the project pages. Are ' +\n        'you sure you want to remove this team from the project %s?',\n      params.projectId\n    );\n    const {projectTeams} = this.state;\n\n    const menuHeader = (\n      <StyledTeamsLabel>\n        {t('Teams')}\n        <Tooltip\n          disabled={canCreateTeam}\n          title={t('You must be a project admin to create teams')}\n          position=\"top\"\n        >\n          <StyledCreateTeamLink\n            to=\"\"\n            disabled={!canCreateTeam}\n            onClick={this.handleCreateTeam}\n          >\n            {t('Create Team')}\n          </StyledCreateTeamLink>\n        </Tooltip>\n      </StyledTeamsLabel>\n    );\n\n    return (\n      <div>\n        <SettingsPageHeader title={t('%s Teams', params.projectId)} />\n        <TeamSelect\n          organization={organization}\n          selectedTeams={projectTeams ?? []}\n          onAddTeam={this.handleAdd}\n          onRemoveTeam={this.handleRemove}\n          menuHeader={menuHeader}\n          confirmLastTeamRemoveMessage={confirmRemove}\n          disabled={!hasAccess}\n        />\n      </div>\n    );\n  }\n}\n\nconst StyledTeamsLabel = styled('div')`\n  font-size: 0.875em;\n  padding: ${space(0.5)} 0px;\n  text-transform: uppercase;\n`;\n\nconst StyledCreateTeamLink = styled(Link)`\n  float: right;\n  text-transform: none;\n  ${p =>\n    p.disabled &&\n    css`\n      cursor: not-allowed;\n      color: ${p.theme.gray300};\n      opacity: 0.6;\n    `};\n`;\n\nexport default ProjectTeams;\n"],"names":["routeTitleGen","routeName","orgSlug","withSentry","projectSlug","tmplBase","tmpl","css","addErrorMessage","openCreateTeamModal","addTeamToProject","removeTeamFromProject","Link","Tooltip","t","space","AsyncView","SettingsPageHeader","TeamSelect","ProjectTeams","organization","props","access","Set","has","teamSlug","state","loading","orgId","projectId","params","api","then","handleRemovedTeam","catch","setState","prevState","projectTeams","filter","team","slug","handleAddedTeam","error","e","project","canCreateTeam","stopPropagation","preventDefault","onClose","data","remountComponent","getEndpoints","getTitle","renderBody","hasAccess","includes","confirmRemove","menuHeader","handleCreateTeam","handleAdd","handleRemove","StyledTeamsLabel","StyledCreateTeamLink","p","disabled","theme","gray300"],"sourceRoot":""}