(globalThis["webpackChunk"] = globalThis["webpackChunk"] || []).push([["app_utils_discover_charts_tsx-app_views_dashboardsV2_widgetBuilder_index_tsx-node_modules_lod-90a90a"],{

/***/ "./app/components/featureFeedback/index.tsx":
/*!**************************************************!*\
  !*** ./app/components/featureFeedback/index.tsx ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FeatureFeedback": () => (/* binding */ FeatureFeedback)
/* harmony export */ });
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var sentry_actionCreators_modal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/actionCreators/modal */ "./app/actionCreators/modal.tsx");
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/icons */ "./app/icons/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");






// Provides a button that, when clicked, opens a modal with a form that,
// when filled and submitted, will send feedback to Sentry (feedbacks project).
function FeatureFeedback(_ref) {
  let {
    feedbackTypes,
    featureName,
    buttonProps = {}
  } = _ref;

  async function handleClick() {
    const mod = await __webpack_require__.e(/*! import() */ "app_components_featureFeedback_feedbackModal_tsx").then(__webpack_require__.bind(__webpack_require__, /*! sentry/components/featureFeedback/feedbackModal */ "./app/components/featureFeedback/feedbackModal.tsx"));
    const {
      FeedbackModal,
      modalCss
    } = mod;
    (0,sentry_actionCreators_modal__WEBPACK_IMPORTED_MODULE_1__.openModal)(deps => (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FeedbackModal, { ...deps,
      featureName: featureName,
      feedbackTypes: feedbackTypes
    }), {
      modalCss
    });
  }

  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_2__["default"], {
    icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_3__.IconMegaphone, {}),
    onClick: handleClick,
    ...buttonProps,
    children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Give Feedback')
  });
}
FeatureFeedback.displayName = "FeatureFeedback";

/***/ }),

/***/ "./app/utils/customMeasurements/customMeasurementsContext.tsx":
/*!********************************************************************!*\
  !*** ./app/utils/customMeasurements/customMeasurementsContext.tsx ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomMeasurementsContext": () => (/* binding */ CustomMeasurementsContext)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

const CustomMeasurementsContext = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(undefined);

/***/ }),

/***/ "./app/utils/customMeasurements/customMeasurementsProvider.tsx":
/*!*********************************************************************!*\
  !*** ./app/utils/customMeasurements/customMeasurementsProvider.tsx ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomMeasurementsProvider": () => (/* binding */ CustomMeasurementsProvider)
/* harmony export */ });
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ "../node_modules/core-js/modules/es.array.includes.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/actionCreators/indicator */ "./app/actionCreators/indicator.tsx");
/* harmony import */ var sentry_components_organizations_pageFilters_parse__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/components/organizations/pageFilters/parse */ "./app/components/organizations/pageFilters/parse.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_utils_handleXhrErrorResponse__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/utils/handleXhrErrorResponse */ "./app/utils/handleXhrErrorResponse.tsx");
/* harmony import */ var sentry_utils_useApi__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/utils/useApi */ "./app/utils/useApi.tsx");
/* harmony import */ var _customMeasurementsContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./customMeasurementsContext */ "./app/utils/customMeasurements/customMeasurementsContext.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");











function fetchCustomMeasurements(api, organization, selection) {
  const query = selection !== null && selection !== void 0 && selection.datetime ? { ...(0,sentry_components_organizations_pageFilters_parse__WEBPACK_IMPORTED_MODULE_4__.normalizeDateTimeParams)(selection.datetime)
  } : {};

  if (selection !== null && selection !== void 0 && selection.projects) {
    query.project = selection.projects.map(String);
  }

  return api.requestPromise(`/organizations/${organization.slug}/measurements-meta/`, {
    method: 'GET',
    query
  });
}

function CustomMeasurementsProvider(_ref) {
  let {
    children,
    organization,
    selection
  } = _ref;
  const api = (0,sentry_utils_useApi__WEBPACK_IMPORTED_MODULE_7__["default"])();
  const [state, setState] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)({
    customMeasurements: {}
  });
  (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {
    let shouldCancelRequest = false;

    if (organization.features.includes('dashboards-mep') || organization.features.includes('mep-rollout-flag')) {
      fetchCustomMeasurements(api, organization, selection).then(response => {
        if (shouldCancelRequest) {
          return;
        }

        const newCustomMeasurements = Object.keys(response).reduce((acc, customMeasurement) => {
          acc[customMeasurement] = {
            key: customMeasurement,
            name: customMeasurement,
            functions: response[customMeasurement].functions
          };
          return acc;
        }, {});
        setState({
          customMeasurements: newCustomMeasurements
        });
      }).catch(e => {
        var _e$responseJSON;

        if (shouldCancelRequest) {
          return;
        }

        const errorResponse = (_e$responseJSON = e === null || e === void 0 ? void 0 : e.responseJSON) !== null && _e$responseJSON !== void 0 ? _e$responseJSON : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_5__.t)('Unable to fetch custom performance metrics');
        (0,sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_3__.addErrorMessage)(errorResponse);
        (0,sentry_utils_handleXhrErrorResponse__WEBPACK_IMPORTED_MODULE_6__["default"])(errorResponse)(e);
      });
    }

    return () => {
      shouldCancelRequest = true;
    };
  }, [selection, api, organization]);
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_customMeasurementsContext__WEBPACK_IMPORTED_MODULE_8__.CustomMeasurementsContext.Provider, {
    value: state,
    children: typeof children === 'function' ? children(state) : children
  });
}
CustomMeasurementsProvider.displayName = "CustomMeasurementsProvider";

/***/ }),

/***/ "./app/utils/discover/charts.tsx":
/*!***************************************!*\
  !*** ./app/utils/discover/charts.tsx ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "axisDuration": () => (/* binding */ axisDuration),
/* harmony export */   "axisLabelFormatter": () => (/* binding */ axisLabelFormatter),
/* harmony export */   "axisLabelFormatterUsingAggregateOutputType": () => (/* binding */ axisLabelFormatterUsingAggregateOutputType),
/* harmony export */   "categorizeDuration": () => (/* binding */ categorizeDuration),
/* harmony export */   "findRangeOfMultiSeries": () => (/* binding */ findRangeOfMultiSeries),
/* harmony export */   "getDurationUnit": () => (/* binding */ getDurationUnit),
/* harmony export */   "tooltipFormatter": () => (/* binding */ tooltipFormatter),
/* harmony export */   "tooltipFormatterUsingAggregateOutputType": () => (/* binding */ tooltipFormatterUsingAggregateOutputType)
/* harmony export */ });
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/utils */ "./app/utils.tsx");
/* harmony import */ var sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/utils/formatters */ "./app/utils/formatters.tsx");




/**
 * Formatter for chart tooltips that handle a variety of discover and metrics result values.
 * If the result is metric values, the value can be of type number or null
 */

function tooltipFormatter(value) {
  let outputType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'number';

  if (!(0,sentry_utils__WEBPACK_IMPORTED_MODULE_2__.defined)(value)) {
    return '\u2014';
  }

  return tooltipFormatterUsingAggregateOutputType(value, outputType);
}
/**
 * Formatter for chart tooltips that takes the aggregate output type directly
 */

function tooltipFormatterUsingAggregateOutputType(value, type) {
  if (!(0,sentry_utils__WEBPACK_IMPORTED_MODULE_2__.defined)(value)) {
    return '\u2014';
  }

  switch (type) {
    case 'integer':
    case 'number':
      return value.toLocaleString();

    case 'percentage':
      return (0,sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.formatPercentage)(value, 2);

    case 'duration':
      return (0,sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.getDuration)(value / 1000, 2, true);

    case 'size':
      return (0,sentry_utils__WEBPACK_IMPORTED_MODULE_2__.formatBytesBase2)(value);

    default:
      return value.toString();
  }
}
/**
 * Formatter for chart axis labels that handle a variety of discover result values
 * This function is *very similar* to tooltipFormatter but outputs data with less precision.
 */

function axisLabelFormatter(value, outputType) {
  let abbreviation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  let durationUnit = arguments.length > 3 ? arguments[3] : undefined;
  return axisLabelFormatterUsingAggregateOutputType(value, outputType, abbreviation, durationUnit);
}
/**
 * Formatter for chart axis labels that takes the aggregate output type directly
 */

function axisLabelFormatterUsingAggregateOutputType(value, type) {
  let abbreviation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  let durationUnit = arguments.length > 3 ? arguments[3] : undefined;

  switch (type) {
    case 'integer':
    case 'number':
      return abbreviation ? (0,sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.formatAbbreviatedNumber)(value) : value.toLocaleString();

    case 'percentage':
      return (0,sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.formatPercentage)(value, 0);

    case 'duration':
      return axisDuration(value, durationUnit);

    case 'size':
      return (0,sentry_utils__WEBPACK_IMPORTED_MODULE_2__.formatBytesBase2)(value, 0);

    default:
      return value.toString();
  }
}
/**
 * Specialized duration formatting for axis labels.
 * In that context we are ok sacrificing accuracy for more
 * consistent sizing.
 *
 * @param value Number of milliseconds to format.
 */

function axisDuration(value, durationUnit) {
  var _durationUnit;

  (_durationUnit = durationUnit) !== null && _durationUnit !== void 0 ? _durationUnit : durationUnit = categorizeDuration(value);

  if (value === 0) {
    return '0';
  }

  switch (durationUnit) {
    case sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.WEEK:
      {
        const label = (value / sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.WEEK).toFixed(0);
        return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('%swk', label);
      }

    case sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.DAY:
      {
        const label = (value / sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.DAY).toFixed(0);
        return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('%sd', label);
      }

    case sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.HOUR:
      {
        const label = (value / sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.HOUR).toFixed(0);
        return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('%shr', label);
      }

    case sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.MINUTE:
      {
        const label = (value / sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.MINUTE).toFixed(0);
        return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('%smin', label);
      }

    case sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.SECOND:
      {
        const label = (value / sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.SECOND).toFixed(0);
        return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('%ss', label);
      }

    default:
      const label = value.toFixed(0);
      return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('%sms', label);
  }
}
/**
 * Given an array of series and an eCharts legend object,
 * finds the range of y values (min and max) based on which series is selected in the legend
 * Assumes series[0] > series[1] > ...
 * @param series Array of eCharts series
 * @param legend eCharts legend object
 * @returns
 */

function findRangeOfMultiSeries(series, legend) {
  var _series$;

  let range;

  if ((_series$ = series[0]) !== null && _series$ !== void 0 && _series$.data) {
    var _maxSeries2;

    let minSeries = series[0];
    let maxSeries;
    series.forEach((_ref, idx) => {
      var _legend$selected;

      let {
        seriesName,
        data
      } = _ref;

      if ((legend === null || legend === void 0 ? void 0 : (_legend$selected = legend.selected) === null || _legend$selected === void 0 ? void 0 : _legend$selected[seriesName]) !== false && data.length) {
        var _maxSeries;

        minSeries = series[idx];
        (_maxSeries = maxSeries) !== null && _maxSeries !== void 0 ? _maxSeries : maxSeries = series[idx];
      }
    });

    if ((_maxSeries2 = maxSeries) !== null && _maxSeries2 !== void 0 && _maxSeries2.data) {
      const max = Math.max(...maxSeries.data.map(_ref2 => {
        let {
          value
        } = _ref2;
        return value;
      }).filter(value => !!value));
      const min = Math.min(...minSeries.data.map(_ref3 => {
        let {
          value
        } = _ref3;
        return value;
      }).filter(value => !!value));
      range = {
        max,
        min
      };
    }
  }

  return range;
}
/**
 * Given a eCharts series and legend, returns the unit to be used on the yAxis for a duration chart
 * @param series eCharts series array
 * @param legend eCharts legend object
 * @returns
 */

function getDurationUnit(series, legend) {
  let durationUnit = 0;
  const range = findRangeOfMultiSeries(series, legend);

  if (range) {
    const avg = (range.max + range.min) / 2;
    durationUnit = categorizeDuration((range.max - range.min) / 5); // avg of 5 yAxis ticks per chart

    const numOfDigits = (avg / durationUnit).toFixed(0).length;

    if (numOfDigits > 6) {
      durationUnit = categorizeDuration(avg);
    }
  }

  return durationUnit;
}
/**
 * Categorizes the duration by Second, Minute, Hour, etc
 * Ex) categorizeDuration(1200) = MINUTE
 * @param value Duration in ms
 */

function categorizeDuration(value) {
  if (value >= sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.WEEK) {
    return sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.WEEK;
  }

  if (value >= sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.DAY) {
    return sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.DAY;
  }

  if (value >= sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.HOUR) {
    return sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.HOUR;
  }

  if (value >= sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.MINUTE) {
    return sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.MINUTE;
  }

  if (value >= sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.SECOND) {
    return sentry_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.SECOND;
  }

  return 1;
}

/***/ }),

/***/ "./app/utils/useCustomMeasurements.tsx":
/*!*********************************************!*\
  !*** ./app/utils/useCustomMeasurements.tsx ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useCustomMeasurements)
/* harmony export */ });
/* harmony import */ var core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.error.cause.js */ "../node_modules/core-js/modules/es.error.cause.js");
/* harmony import */ var core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var sentry_utils_customMeasurements_customMeasurementsContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/utils/customMeasurements/customMeasurementsContext */ "./app/utils/customMeasurements/customMeasurementsContext.tsx");



function useCustomMeasurements() {
  const customMeasurementsContext = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(sentry_utils_customMeasurements_customMeasurementsContext__WEBPACK_IMPORTED_MODULE_2__.CustomMeasurementsContext);

  if (!customMeasurementsContext) {
    throw new Error('useCustomMeasurements was called outside of CustomMeasurementsProvider');
  }

  return customMeasurementsContext;
}

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/columnsStep/columnFields.tsx":
/*!**************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/columnsStep/columnFields.tsx ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ColumnFields": () => (/* binding */ ColumnFields)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ "../node_modules/core-js/modules/es.array.includes.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/components/forms/field */ "./app/components/forms/field/index.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var sentry_views_eventsV2_table_columnEditCollection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/views/eventsV2/table/columnEditCollection */ "./app/views/eventsV2/table/columnEditCollection.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");








function ColumnFields(_ref) {
  var _errors$find;

  let {
    displayType,
    fieldOptions,
    widgetType,
    fields,
    organization,
    errors,
    onChange,
    filterAggregateParameters,
    filterPrimaryOptions,
    noFieldsMessage
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_3__["default"], {
    inline: false,
    error: errors === null || errors === void 0 ? void 0 : (_errors$find = errors.find(error => error === null || error === void 0 ? void 0 : error.fields)) === null || _errors$find === void 0 ? void 0 : _errors$find.fields,
    flexibleControlStateSize: true,
    stacked: true,
    children: displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_5__.DisplayType.TABLE ? (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(ColumnCollectionEdit, {
      columns: fields,
      onChange: onChange,
      fieldOptions: fieldOptions,
      organization: organization,
      source: widgetType,
      showAliasField: organization.features.includes('new-widget-builder-experience-design'),
      filterAggregateParameters: filterAggregateParameters,
      filterPrimaryOptions: filterPrimaryOptions,
      noFieldsMessage: noFieldsMessage
    }) : // The only other display type this component
    // renders for is TOP_N, where the n - 1 fields
    // are columns and the nth field is the y-axis
    (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(ColumnCollectionEdit, {
      columns: fields.slice(0, fields.length - 1),
      onChange: newColumns => {
        onChange([...newColumns, fields[fields.length - 1]]);
      },
      fieldOptions: fieldOptions,
      organization: organization,
      source: widgetType,
      filterPrimaryOptions: filterPrimaryOptions,
      noFieldsMessage: noFieldsMessage
    })
  });
}
ColumnFields.displayName = "ColumnFields";

const ColumnCollectionEdit = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_views_eventsV2_table_columnEditCollection__WEBPACK_IMPORTED_MODULE_6__["default"],  true ? {
  target: "e2w4m990"
} : 0)("margin-top:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_4__["default"])(1), ";" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/columnsStep/index.tsx":
/*!*******************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/columnsStep/index.tsx ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ColumnsStep": () => (/* binding */ ColumnsStep)
/* harmony export */ });
/* harmony import */ var sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/components/links/externalLink */ "./app/components/links/externalLink.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_utils_useCustomMeasurements__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/utils/useCustomMeasurements */ "./app/utils/useCustomMeasurements.tsx");
/* harmony import */ var sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/views/dashboardsV2/datasetConfig/base */ "./app/views/dashboardsV2/datasetConfig/base.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils */ "./app/views/dashboardsV2/widgetBuilder/utils.tsx");
/* harmony import */ var _buildStep__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../buildStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx");
/* harmony import */ var _columnFields__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./columnFields */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/columnsStep/columnFields.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");








function ColumnsStep(_ref) {
  let {
    dataSet,
    displayType,
    organization,
    widgetType,
    handleColumnFieldChange,
    queryErrors,
    explodedFields,
    tags
  } = _ref;
  const {
    customMeasurements
  } = (0,sentry_utils_useCustomMeasurements__WEBPACK_IMPORTED_MODULE_2__["default"])();
  const datasetConfig = (0,sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_3__.getDatasetConfig)(widgetType);
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_buildStep__WEBPACK_IMPORTED_MODULE_5__.BuildStep, {
    title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('Choose your columns'),
    description: dataSet === _utils__WEBPACK_IMPORTED_MODULE_4__.DataSet.ISSUES ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.tct)('[fieldTagLink: Field and tag] columns will help you view more details about the issues (e.g., title).', {
      fieldTagLink: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_0__["default"], {
        href: "https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"
      })
    }) : dataSet === _utils__WEBPACK_IMPORTED_MODULE_4__.DataSet.RELEASES ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.tct)('To stack sessions, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the sessions (e.g., releases).', {
      functionLink: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_0__["default"], {
        href: "https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"
      }),
      fieldTagLink: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_0__["default"], {
        href: "https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#release-properties"
      })
    }) : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.tct)('To stack events, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the events (e.g., title).', {
      functionLink: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_0__["default"], {
        href: "https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"
      }),
      fieldTagLink: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_0__["default"], {
        href: "https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"
      })
    }),
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_columnFields__WEBPACK_IMPORTED_MODULE_6__.ColumnFields, {
      displayType: displayType,
      organization: organization,
      widgetType: widgetType,
      fields: explodedFields,
      errors: queryErrors,
      fieldOptions: datasetConfig.getTableFieldOptions(organization, tags, customMeasurements),
      filterAggregateParameters: datasetConfig.filterAggregateParams,
      filterPrimaryOptions: datasetConfig.filterTableOptions,
      onChange: handleColumnFieldChange
    })
  });
}
ColumnsStep.displayName = "ColumnsStep";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/dataSetStep.tsx":
/*!*************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/dataSetStep.tsx ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DataSetStep": () => (/* binding */ DataSetStep)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var sentry_components_featureBadge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/components/featureBadge */ "./app/components/featureBadge.tsx");
/* harmony import */ var sentry_components_forms_controls_radioGroup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/components/forms/controls/radioGroup */ "./app/components/forms/controls/radioGroup.tsx");
/* harmony import */ var sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/components/links/externalLink */ "./app/components/links/externalLink.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils */ "./app/views/dashboardsV2/widgetBuilder/utils.tsx");
/* harmony import */ var _buildStep__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./buildStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");













const DATASET_CHOICES = [[_utils__WEBPACK_IMPORTED_MODULE_9__.DataSet.EVENTS, (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Errors and Transactions')], [_utils__WEBPACK_IMPORTED_MODULE_9__.DataSet.ISSUES, (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Issues (States, Assignment, Time, etc.)')]];
function DataSetStep(_ref) {
  let {
    dataSet,
    onChange,
    hasReleaseHealthFeature,
    displayType
  } = _ref;
  const disabledChoices = [];

  if (displayType !== sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_8__.DisplayType.TABLE) {
    disabledChoices.push([_utils__WEBPACK_IMPORTED_MODULE_9__.DataSet.ISSUES, (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('This dataset is restricted to tabular visualization.')]);

    if (displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_8__.DisplayType.WORLD_MAP) {
      disabledChoices.push([_utils__WEBPACK_IMPORTED_MODULE_9__.DataSet.RELEASES, (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('This dataset is restricted to big number, tabular and time series visualizations.')]);
    }
  }

  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_buildStep__WEBPACK_IMPORTED_MODULE_10__.BuildStep, {
    title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Choose your dataset'),
    description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.tct)(`This reflects the type of information you want to use. To learn more, [link: read the docs].`, {
      link: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(sentry_components_links_externalLink__WEBPACK_IMPORTED_MODULE_5__["default"], {
        href: "https://docs.sentry.io/product/dashboards/widget-builder/#choose-your-dataset"
      })
    }),
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(DataSetChoices, {
      label: "dataSet",
      value: dataSet,
      choices: hasReleaseHealthFeature ? [...DATASET_CHOICES, [_utils__WEBPACK_IMPORTED_MODULE_9__.DataSet.RELEASES, (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsxs)(react__WEBPACK_IMPORTED_MODULE_2__.Fragment, {
        children: [(0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Releases (Sessions, Crash rates)'), " ", (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(sentry_components_featureBadge__WEBPACK_IMPORTED_MODULE_3__["default"], {
          type: "new"
        })]
      }, "releases-dataset")]] : DATASET_CHOICES,
      disabledChoices: disabledChoices,
      onChange: newDataSet => {
        onChange(newDataSet);
      }
    })
  });
}
DataSetStep.displayName = "DataSetStep";

const DataSetChoices = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_forms_controls_radioGroup__WEBPACK_IMPORTED_MODULE_4__["default"],  true ? {
  target: "e1eujfdx0"
} : 0)("display:flex;flex-wrap:wrap;gap:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_7__["default"])(2), ";" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/index.tsx":
/*!*************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/index.tsx ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FilterResultsStep": () => (/* binding */ FilterResultsStep)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var sentry_components_acl_feature__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/components/acl/feature */ "./app/components/acl/feature.tsx");
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/components/buttonBar */ "./app/components/buttonBar.tsx");
/* harmony import */ var sentry_components_datePageFilter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/components/datePageFilter */ "./app/components/datePageFilter.tsx");
/* harmony import */ var sentry_components_environmentPageFilter__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/components/environmentPageFilter */ "./app/components/environmentPageFilter.tsx");
/* harmony import */ var sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/components/forms/field */ "./app/components/forms/field/index.tsx");
/* harmony import */ var sentry_components_input__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! sentry/components/input */ "./app/components/input.tsx");
/* harmony import */ var sentry_components_organizations_pageFilterBar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! sentry/components/organizations/pageFilterBar */ "./app/components/organizations/pageFilterBar.tsx");
/* harmony import */ var sentry_components_projectPageFilter__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! sentry/components/projectPageFilter */ "./app/components/projectPageFilter.tsx");
/* harmony import */ var sentry_icons__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! sentry/icons */ "./app/icons/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_utils_queryString__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! sentry/utils/queryString */ "./app/utils/queryString.tsx");
/* harmony import */ var sentry_utils_releases_releasesProvider__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! sentry/utils/releases/releasesProvider */ "./app/utils/releases/releasesProvider.tsx");
/* harmony import */ var sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! sentry/views/dashboardsV2/datasetConfig/base */ "./app/views/dashboardsV2/datasetConfig/base.tsx");
/* harmony import */ var sentry_views_dashboardsV2_releasesSelectControl__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! sentry/views/dashboardsV2/releasesSelectControl */ "./app/views/dashboardsV2/releasesSelectControl.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var _buildStep__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../buildStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");


function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }






















function FilterResultsStep(_ref) {
  var _ref2;

  let {
    canAddSearchConditions,
    dashboardFilters,
    location,
    queries,
    onQueryRemove,
    onAddSearchConditions,
    onQueryChange,
    organization,
    hideLegendAlias,
    queryErrors,
    widgetType,
    selection
  } = _ref;
  const handleSearch = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(queryIndex => {
    return field => {
      const newQuery = { ...queries[queryIndex],
        conditions: field
      };
      onQueryChange(queryIndex, newQuery);
    };
  }, [onQueryChange, queries]);
  const handleClose = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(queryIndex => {
    return field => {
      const newQuery = { ...queries[queryIndex],
        conditions: field
      };
      onQueryChange(queryIndex, newQuery);
    };
  }, [onQueryChange, queries]);
  const datasetConfig = (0,sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_16__.getDatasetConfig)(widgetType);
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)(_buildStep__WEBPACK_IMPORTED_MODULE_19__.BuildStep, {
    title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('Filter your results'),
    description: canAddSearchConditions ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('This is how you filter down your search. You can add multiple queries to compare data for each overlay.') : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('This is how you filter down your search.'),
    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)(sentry_components_acl_feature__WEBPACK_IMPORTED_MODULE_2__["default"], {
      features: ['dashboards-top-level-filter'],
      children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)(StyledPageFilterBar, {
        children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_components_projectPageFilter__WEBPACK_IMPORTED_MODULE_10__["default"], {
          disabled: true
        }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_components_environmentPageFilter__WEBPACK_IMPORTED_MODULE_6__["default"], {
          disabled: true
        }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_components_datePageFilter__WEBPACK_IMPORTED_MODULE_5__["default"], {
          alignDropdown: "left",
          disabled: true
        })]
      }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(FilterButtons, {
        children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_utils_releases_releasesProvider__WEBPACK_IMPORTED_MODULE_15__.ReleasesProvider, {
          organization: organization,
          selection: selection,
          children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(StyledReleasesSelectControl, {
            selectedReleases: (_ref2 = sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_18__.DashboardFilterKeys.RELEASE in location.query ? (0,sentry_utils_queryString__WEBPACK_IMPORTED_MODULE_14__.decodeList)(location.query[sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_18__.DashboardFilterKeys.RELEASE]) : dashboardFilters === null || dashboardFilters === void 0 ? void 0 : dashboardFilters[sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_18__.DashboardFilterKeys.RELEASE]) !== null && _ref2 !== void 0 ? _ref2 : [],
            isDisabled: true,
            className: "widget-release-select"
          })
        })
      })]
    }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)("div", {
      children: [queries.map((query, queryIndex) => {
        var _queryErrors$queryInd;

        return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(QueryField, {
          inline: false,
          flexibleControlStateSize: true,
          stacked: true,
          error: queryErrors === null || queryErrors === void 0 ? void 0 : (_queryErrors$queryInd = queryErrors[queryIndex]) === null || _queryErrors$queryInd === void 0 ? void 0 : _queryErrors$queryInd.conditions,
          children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)(SearchConditionsWrapper, {
            children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(datasetConfig.SearchBar, {
              organization: organization,
              pageFilters: selection,
              onClose: handleClose(queryIndex),
              onSearch: handleSearch(queryIndex),
              widgetQuery: query
            }), !hideLegendAlias && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(LegendAliasInput, {
              type: "text",
              name: "name",
              value: query.name,
              placeholder: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('Legend Alias'),
              onChange: event => {
                const newQuery = { ...queries[queryIndex],
                  name: event.target.value
                };
                onQueryChange(queryIndex, newQuery);
              }
            }), queries.length > 1 && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_3__["default"], {
              size: "zero",
              borderless: true,
              onClick: () => onQueryRemove(queryIndex),
              icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_11__.IconDelete, {}),
              title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('Remove query'),
              "aria-label": (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('Remove query')
            })]
          })
        }, queryIndex);
      }), canAddSearchConditions && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_3__["default"], {
        size: "sm",
        icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_11__.IconAdd, {
          isCircled: true
        }),
        onClick: onAddSearchConditions,
        children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_12__.t)('Add Query')
      })]
    })]
  });
}
FilterResultsStep.displayName = "FilterResultsStep";

const LegendAliasInput = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_input__WEBPACK_IMPORTED_MODULE_8__["default"],  true ? {
  target: "e12061i95"
} : 0)( true ? {
  name: "1f6lq61",
  styles: "width:33%"
} : 0);

const QueryField = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_7__["default"],  true ? {
  target: "e12061i94"
} : 0)("padding-bottom:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__["default"])(1), ";" + ( true ? "" : 0));

const StyledPageFilterBar = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_organizations_pageFilterBar__WEBPACK_IMPORTED_MODULE_9__["default"],  true ? {
  target: "e12061i93"
} : 0)("margin-bottom:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__["default"])(1), ";margin-right:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__["default"])(2), ";" + ( true ? "" : 0));

const FilterButtons = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_4__["default"],  true ? {
  target: "e12061i92"
} : 0)("grid-template-columns:1fr;margin-bottom:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__["default"])(1), ";margin-right:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__["default"])(2), ";justify-content:space-between;" + ( true ? "" : 0));

const StyledReleasesSelectControl = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_views_dashboardsV2_releasesSelectControl__WEBPACK_IMPORTED_MODULE_17__["default"],  true ? {
  target: "e12061i91"
} : 0)( true ? {
  name: "f0iau4",
  styles: "button{width:100%;}"
} : 0);

const SearchConditionsWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "e12061i90"
} : 0)("display:flex;align-items:center;>*+*{margin-left:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_13__["default"])(1), ";}" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/groupBySelector.tsx":
/*!*****************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/groupBySelector.tsx ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "GroupBySelector": () => (/* binding */ GroupBySelector)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _dnd_kit_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dnd-kit/core */ "../node_modules/@dnd-kit/core/dist/core.esm.js");
/* harmony import */ var _dnd_kit_sortable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dnd-kit/sortable */ "../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/components/forms/field */ "./app/components/forms/field/index.tsx");
/* harmony import */ var sentry_icons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/icons */ "./app/icons/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! sentry/utils */ "./app/utils.tsx");
/* harmony import */ var sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! sentry/utils/discover/fields */ "./app/utils/discover/fields.tsx");
/* harmony import */ var sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! sentry/views/eventsV2/table/types */ "./app/views/eventsV2/table/types.tsx");
/* harmony import */ var _queryField__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./queryField */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/queryField.tsx");
/* harmony import */ var _sortableQueryField__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./sortableQueryField */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/sortableQueryField.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");



function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }
















const GROUP_BY_LIMIT = 20;
const EMPTY_FIELD = {
  kind: sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__.FieldValueKind.FIELD,
  field: ''
};
function GroupBySelector(_ref) {
  var _columns$;

  let {
    fieldOptions,
    columns = [],
    onChange
  } = _ref;
  const [activeId, setActiveId] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);

  function handleAdd() {
    const newColumns = columns.length === 0 ? [{ ...EMPTY_FIELD
    }, { ...EMPTY_FIELD
    }] : [...columns, { ...EMPTY_FIELD
    }];
    onChange(newColumns);
  }

  function handleSelect(value, index) {
    const newColumns = [...columns];

    if (columns.length === 0) {
      newColumns.push(value);
    } else if ((0,sentry_utils__WEBPACK_IMPORTED_MODULE_10__.defined)(index)) {
      newColumns[index] = value;
    }

    onChange(newColumns);
  }

  function handleRemove(index) {
    const newColumns = [...columns];
    newColumns.splice(index, 1);
    onChange(newColumns);
  }

  const hasOnlySingleColumnWithValue = columns.length === 1 && columns[0].kind === sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__.FieldValueKind.FIELD && ((_columns$ = columns[0]) === null || _columns$ === void 0 ? void 0 : _columns$.field) !== '';
  const canDrag = columns.length > 1;
  const canDelete = canDrag || hasOnlySingleColumnWithValue;
  const columnFieldsAsString = columns.map(sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_11__.generateFieldAsString);
  const {
    filteredFieldOptions,
    columnsAsFieldOptions
  } = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {
    return Object.keys(fieldOptions).reduce((acc, key) => {
      const value = fieldOptions[key];
      const optionInColumnsIndex = columnFieldsAsString.findIndex(column => column === value.value.meta.name);

      if (optionInColumnsIndex === -1) {
        acc.filteredFieldOptions[key] = value;
        return acc;
      }

      acc.columnsAsFieldOptions[optionInColumnsIndex] = {
        [key]: value
      };
      return acc;
    }, {
      filteredFieldOptions: {},
      columnsAsFieldOptions: []
    });
  }, [fieldOptions, columns]);
  const items = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {
    return columns.reduce((acc, _column, index) => {
      acc.push(String(index));
      return acc;
    }, []);
  }, [columns]);
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)(react__WEBPACK_IMPORTED_MODULE_2__.Fragment, {
    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(StyledField, {
      inline: false,
      flexibleControlStateSize: true,
      stacked: true,
      children: columns.length === 0 ? (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_queryField__WEBPACK_IMPORTED_MODULE_13__.QueryField, {
        value: EMPTY_FIELD,
        fieldOptions: filteredFieldOptions,
        onChange: value => handleSelect(value, 0),
        canDelete: canDelete
      }) : (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)(_dnd_kit_core__WEBPACK_IMPORTED_MODULE_3__.DndContext, {
        collisionDetection: _dnd_kit_core__WEBPACK_IMPORTED_MODULE_3__.closestCenter,
        onDragStart: _ref2 => {
          let {
            active
          } = _ref2;
          setActiveId(active.id);
        },
        onDragEnd: _ref3 => {
          let {
            over,
            active
          } = _ref3;
          setActiveId(null);

          if (over) {
            const getIndex = items.indexOf.bind(items);
            const activeIndex = getIndex(active.id);
            const overIndex = getIndex(over.id);

            if (activeIndex !== overIndex) {
              onChange((0,_dnd_kit_sortable__WEBPACK_IMPORTED_MODULE_4__.arrayMove)(columns, activeIndex, overIndex));
            }
          }
        },
        onDragCancel: () => {
          setActiveId(null);
        },
        children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_dnd_kit_sortable__WEBPACK_IMPORTED_MODULE_4__.SortableContext, {
          items: items,
          strategy: _dnd_kit_sortable__WEBPACK_IMPORTED_MODULE_4__.verticalListSortingStrategy,
          children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(SortableQueryFields, {
            children: columns.map((column, index) => (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_sortableQueryField__WEBPACK_IMPORTED_MODULE_14__.SortableQueryField, {
              dragId: items[index],
              value: column,
              fieldOptions: { ...filteredFieldOptions,
                ...columnsAsFieldOptions[index]
              },
              onChange: value => handleSelect(value, index),
              onDelete: () => handleRemove(index),
              canDrag: canDrag,
              canDelete: canDelete
            }, items[index]))
          })
        }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_dnd_kit_core__WEBPACK_IMPORTED_MODULE_3__.DragOverlay, {
          dropAnimation: null,
          children: activeId ? (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(Ghost, {
            children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_queryField__WEBPACK_IMPORTED_MODULE_13__.QueryField, {
              value: columns[Number(activeId)],
              fieldOptions: { ...filteredFieldOptions,
                ...columnsAsFieldOptions[Number(activeId)]
              },
              onChange: value => handleSelect(value, Number(activeId)),
              canDrag: canDrag,
              canDelete: canDelete
            })
          }) : null
        })]
      })
    }), columns.length < GROUP_BY_LIMIT && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(AddGroupButton, {
      size: "sm",
      icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_7__.IconAdd, {
        isCircled: true
      }),
      onClick: handleAdd,
      children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_8__.t)('Add Group')
    })]
  });
}
GroupBySelector.displayName = "GroupBySelector";

const StyledField = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_6__["default"],  true ? {
  target: "esrd23w3"
} : 0)("padding-bottom:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_9__["default"])(1), ";" + ( true ? "" : 0));

const AddGroupButton = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_button__WEBPACK_IMPORTED_MODULE_5__["default"],  true ? {
  target: "esrd23w2"
} : 0)( true ? {
  name: "b9l38d",
  styles: "width:min-content"
} : 0);

const SortableQueryFields = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "esrd23w1"
} : 0)("display:grid;grid-auto-flow:row;gap:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_9__["default"])(1), ";" + ( true ? "" : 0));

const Ghost = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "esrd23w0"
} : 0)("position:absolute;background:", p => p.theme.background, ";padding:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_9__["default"])(0.5), ";border-radius:", p => p.theme.borderRadius, ";box-shadow:0 0 15px rgba(0, 0, 0, 0.15);opacity:0.8;cursor:grabbing;padding-right:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_9__["default"])(2), ";width:100%;button{cursor:grabbing;}@media (min-width: ", p => p.theme.breakpoints.small, "){width:710px;}" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/index.tsx":
/*!*******************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/index.tsx ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "GroupByStep": () => (/* binding */ GroupByStep)
/* harmony export */ });
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/views/dashboardsV2/datasetConfig/base */ "./app/views/dashboardsV2/datasetConfig/base.tsx");
/* harmony import */ var _widgetBuilder__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../widgetBuilder */ "./app/views/dashboardsV2/widgetBuilder/widgetBuilder.tsx");
/* harmony import */ var _buildStep__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../buildStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx");
/* harmony import */ var _groupBySelector__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./groupBySelector */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/groupBySelector.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");






function GroupByStep(_ref) {
  let {
    dataSet,
    columns,
    onGroupByChange,
    organization,
    tags
  } = _ref;
  const datasetConfig = (0,sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_1__.getDatasetConfig)(_widgetBuilder__WEBPACK_IMPORTED_MODULE_2__.DATA_SET_TO_WIDGET_TYPE[dataSet]);
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_buildStep__WEBPACK_IMPORTED_MODULE_3__.BuildStep, {
    title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Group your results'),
    description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('This is how you can group your data result by field or tag.'),
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_groupBySelector__WEBPACK_IMPORTED_MODULE_4__.GroupBySelector, {
      columns: columns,
      fieldOptions: datasetConfig.getGroupByFieldOptions ? datasetConfig.getGroupByFieldOptions(organization, tags) : {},
      onChange: onGroupByChange
    })
  });
}
GroupByStep.displayName = "GroupByStep";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/queryField.tsx":
/*!************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/queryField.tsx ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "QueryField": () => (/* binding */ QueryField)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/icons */ "./app/icons/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_views_eventsV2_table_queryField__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/views/eventsV2/table/queryField */ "./app/views/eventsV2/table/queryField.tsx");
/* harmony import */ var sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/views/eventsV2/table/types */ "./app/views/eventsV2/table/types.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");


function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }










function QueryField(_ref) {
  let {
    onDelete,
    onChange,
    fieldOptions,
    value,
    forwardRef,
    listeners,
    attributes,
    canDelete,
    canDrag,
    style,
    isDragging
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(QueryFieldWrapper, {
    ref: forwardRef,
    style: style,
    children: isDragging ? null : (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, {
      children: [canDrag && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(DragAndReorderButton, { ...listeners,
        ...attributes,
        "aria-label": (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Drag to reorder'),
        icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_3__.IconGrabbable, {
          size: "xs"
        }),
        size: "zero",
        borderless: true
      }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(sentry_views_eventsV2_table_queryField__WEBPACK_IMPORTED_MODULE_6__.QueryField, {
        placeholder: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Select group'),
        fieldValue: value,
        fieldOptions: fieldOptions,
        onChange: onChange,
        filterPrimaryOptions: option => option.value.kind !== sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_7__.FieldValueKind.FUNCTION
      }), canDelete && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_2__["default"], {
        size: "zero",
        borderless: true,
        onClick: onDelete,
        icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_3__.IconDelete, {}),
        title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Remove group'),
        "aria-label": (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Remove group')
      })]
    })
  });
}
QueryField.displayName = "QueryField";

const DragAndReorderButton = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_button__WEBPACK_IMPORTED_MODULE_2__["default"],  true ? {
  target: "epp8h3j1"
} : 0)( true ? {
  name: "1k18kha",
  styles: "height:40px"
} : 0);

const QueryFieldWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "epp8h3j0"
} : 0)("display:flex;align-items:center;justify-content:space-between;width:100%;>*+*{margin-left:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(1), ";}" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/sortableQueryField.tsx":
/*!********************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/sortableQueryField.tsx ***!
  \********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SortableQueryField": () => (/* binding */ SortableQueryField)
/* harmony export */ });
/* harmony import */ var _dnd_kit_sortable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dnd-kit/sortable */ "../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");
/* harmony import */ var _dnd_kit_utilities__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dnd-kit/utilities */ "../node_modules/@dnd-kit/utilities/dist/utilities.esm.js");
/* harmony import */ var _emotion_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @emotion/react */ "../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js");
/* harmony import */ var _queryField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./queryField */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/queryField.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");





function SortableQueryField(_ref) {
  let {
    dragId,
    ...props
  } = _ref;
  const theme = (0,_emotion_react__WEBPACK_IMPORTED_MODULE_3__.a)();
  const {
    listeners,
    setNodeRef,
    transform,
    transition,
    attributes,
    isDragging
  } = (0,_dnd_kit_sortable__WEBPACK_IMPORTED_MODULE_0__.useSortable)({
    id: dragId,
    transition: null
  });
  let style = {
    transform: _dnd_kit_utilities__WEBPACK_IMPORTED_MODULE_1__.CSS.Transform.toString(transform),
    transition,
    zIndex: 'auto'
  };

  if (isDragging) {
    style = { ...style,
      zIndex: 100,
      height: '40px',
      border: `2px dashed ${theme.border}`,
      borderRadius: theme.borderRadius
    };
  }

  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_queryField__WEBPACK_IMPORTED_MODULE_2__.QueryField, {
    forwardRef: setNodeRef,
    listeners: listeners,
    attributes: attributes,
    isDragging: isDragging,
    style: style,
    ...props
  });
}
SortableQueryField.displayName = "SortableQueryField";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/visualizationStep.tsx":
/*!*******************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/visualizationStep.tsx ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VisualizationStep": () => (/* binding */ VisualizationStep)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _emotion_react__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @emotion/react */ "../node_modules/@emotion/react/dist/emotion-react.browser.esm.js");
/* harmony import */ var lodash_debounce__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/debounce */ "../node_modules/lodash/debounce.js");
/* harmony import */ var lodash_debounce__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var lodash_isEqual__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash/isEqual */ "../node_modules/lodash/isEqual.js");
/* harmony import */ var lodash_isEqual__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_isEqual__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var sentry_components_charts_simpleTableChart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/components/charts/simpleTableChart */ "./app/components/charts/simpleTableChart.tsx");
/* harmony import */ var sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/components/forms/field */ "./app/components/forms/field/index.tsx");
/* harmony import */ var sentry_components_forms_selectControl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/components/forms/selectControl */ "./app/components/forms/selectControl.tsx");
/* harmony import */ var sentry_components_panels__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! sentry/components/panels */ "./app/components/panels/index.tsx");
/* harmony import */ var sentry_constants__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! sentry/constants */ "./app/constants/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_utils_usePrevious__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! sentry/utils/usePrevious */ "./app/utils/usePrevious.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../utils */ "./app/views/dashboardsV2/utils.tsx");
/* harmony import */ var _widgetCard__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../widgetCard */ "./app/views/dashboardsV2/widgetCard/index.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../utils */ "./app/views/dashboardsV2/widgetBuilder/utils.tsx");
/* harmony import */ var _buildStep__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./buildStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");





















function VisualizationStep(_ref) {
  var _getDashboardFiltersF;

  let {
    organization,
    pageFilters,
    displayType,
    error,
    onChange,
    widget,
    noDashboardsMEPProvider,
    dashboardFilters,
    location
  } = _ref;
  const [debouncedWidget, setDebouncedWidget] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(widget);
  const previousWidget = (0,sentry_utils_usePrevious__WEBPACK_IMPORTED_MODULE_12__["default"])(widget); // Disabling for now because we use debounce to avoid excessively hitting
  // our endpoints, but useCallback wants an inline function and not one
  // returned from debounce
  // eslint-disable-next-line react-hooks/exhaustive-deps

  const debounceWidget = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(lodash_debounce__WEBPACK_IMPORTED_MODULE_3___default()((value, shouldCancelUpdates) => {
    if (shouldCancelUpdates) {
      return;
    }

    setDebouncedWidget(value);
  }, sentry_constants__WEBPACK_IMPORTED_MODULE_9__.DEFAULT_DEBOUNCE_DURATION), []);
  (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {
    let shouldCancelUpdates = false;

    if (!lodash_isEqual__WEBPACK_IMPORTED_MODULE_4___default()(previousWidget, widget)) {
      debounceWidget(widget, shouldCancelUpdates);
    }

    return () => {
      shouldCancelUpdates = true;
    };
  }, [widget, previousWidget, debounceWidget]);
  const displayOptions = Object.keys(_utils__WEBPACK_IMPORTED_MODULE_16__.displayTypes).map(value => ({
    label: _utils__WEBPACK_IMPORTED_MODULE_16__.displayTypes[value],
    value
  }));
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__.jsxs)(_buildStep__WEBPACK_IMPORTED_MODULE_17__.BuildStep, {
    title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_10__.t)('Choose your visualization'),
    description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_10__.t)('This is a preview of how your widget will appear in the dashboard.'),
    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__.jsx)(sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_6__["default"], {
      error: error,
      inline: false,
      flexibleControlStateSize: true,
      stacked: true,
      children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__.jsx)(sentry_components_forms_selectControl__WEBPACK_IMPORTED_MODULE_7__["default"], {
        name: "displayType",
        options: displayOptions,
        value: displayType,
        onChange: option => {
          onChange(option.value);
        },
        styles: {
          singleValue: provided => ({ ...provided,
            width: `calc(100% - ${(0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_11__["default"])(1)})`
          })
        }
      })
    }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__.jsx)(VisualizationWrapper, {
      displayType: displayType,
      children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__.jsx)(_widgetCard__WEBPACK_IMPORTED_MODULE_15__["default"], {
        organization: organization,
        selection: pageFilters,
        widget: debouncedWidget,
        dashboardFilters: (_getDashboardFiltersF = (0,_utils__WEBPACK_IMPORTED_MODULE_14__.getDashboardFiltersFromURL)(location)) !== null && _getDashboardFiltersF !== void 0 ? _getDashboardFiltersF : dashboardFilters,
        isEditing: false,
        widgetLimitReached: false,
        renderErrorMessage: errorMessage => typeof errorMessage === 'string' && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_18__.jsx)(sentry_components_panels__WEBPACK_IMPORTED_MODULE_8__.PanelAlert, {
          type: "error",
          children: errorMessage
        }),
        isSorting: false,
        currentWidgetDragging: false,
        noLazyLoad: true,
        showStoredAlert: true,
        noDashboardsMEPProvider: noDashboardsMEPProvider
      })
    })]
  });
}
VisualizationStep.displayName = "VisualizationStep";

const VisualizationWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "e1huhsf60"
} : 0)("padding-right:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_11__["default"])(2), ";", _widgetCard__WEBPACK_IMPORTED_MODULE_15__.WidgetCardPanel, "{height:initial;}", p => p.displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_13__.DisplayType.TABLE && /*#__PURE__*/(0,_emotion_react__WEBPACK_IMPORTED_MODULE_19__.css)("overflow:hidden;", sentry_components_charts_simpleTableChart__WEBPACK_IMPORTED_MODULE_5__.TableCell, "{height:41px;}", _widgetCard__WEBPACK_IMPORTED_MODULE_15__.WidgetCardPanel, "{height:301px;}" + ( true ? "" : 0),  true ? "" : 0), ";" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/index.tsx":
/*!*****************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/index.tsx ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "YAxisStep": () => (/* binding */ YAxisStep)
/* harmony export */ });
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ "../node_modules/core-js/modules/es.array.includes.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var _buildStep__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../buildStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx");
/* harmony import */ var _yAxisSelector__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./yAxisSelector */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/index.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");






function YAxisStep(_ref) {
  let {
    displayType,
    queryErrors,
    aggregates,
    onYAxisChange,
    tags,
    widgetType
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_buildStep__WEBPACK_IMPORTED_MODULE_3__.BuildStep, {
    title: displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.BIG_NUMBER ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('Choose what to plot') : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)('Choose what to plot in the y-axis'),
    description: [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.AREA, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.BAR, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.LINE].includes(displayType) ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)("This is the data you'd be visualizing in the display. If the overlay units conflict, the charts will always base it off of the first line.") : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_1__.t)("This is the data you'd be visualizing in the display."),
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_yAxisSelector__WEBPACK_IMPORTED_MODULE_4__.YAxisSelector, {
      widgetType: widgetType,
      displayType: displayType,
      aggregates: aggregates,
      onChange: onYAxisChange,
      tags: tags,
      errors: queryErrors
    })
  });
}
YAxisStep.displayName = "YAxisStep";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/addButton.tsx":
/*!***********************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/addButton.tsx ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AddButton": () => (/* binding */ AddButton)
/* harmony export */ });
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_icons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/icons */ "./app/icons/index.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");



function AddButton(_ref) {
  let {
    title,
    onAdd
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_0__["default"], {
    size: "sm",
    onClick: onAdd,
    icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_1__.IconAdd, {
      isCircled: true
    }),
    children: title
  });
}
AddButton.displayName = "AddButton";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/deleteButton.tsx":
/*!**************************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/deleteButton.tsx ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DeleteButton": () => (/* binding */ DeleteButton)
/* harmony export */ });
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_icons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/icons */ "./app/icons/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");




function DeleteButton(_ref) {
  let {
    onDelete
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_0__["default"], {
    size: "zero",
    borderless: true,
    onClick: onDelete,
    icon: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(sentry_icons__WEBPACK_IMPORTED_MODULE_1__.IconDelete, {}),
    title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_2__.t)('Remove this Y-Axis'),
    "aria-label": (0,sentry_locale__WEBPACK_IMPORTED_MODULE_2__.t)('Remove this Y-Axis')
  });
}
DeleteButton.displayName = "DeleteButton";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/index.tsx":
/*!*******************************************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/index.tsx ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "YAxisSelector": () => (/* binding */ YAxisSelector)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ "../node_modules/core-js/modules/es.array.includes.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/components/buttonBar */ "./app/components/buttonBar.tsx");
/* harmony import */ var sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/components/forms/field */ "./app/components/forms/field/index.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_utils_useCustomMeasurements__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/utils/useCustomMeasurements */ "./app/utils/useCustomMeasurements.tsx");
/* harmony import */ var sentry_utils_useOrganization__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! sentry/utils/useOrganization */ "./app/utils/useOrganization.tsx");
/* harmony import */ var sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! sentry/views/dashboardsV2/datasetConfig/base */ "./app/views/dashboardsV2/datasetConfig/base.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var sentry_views_eventsV2_table_queryField__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! sentry/views/eventsV2/table/queryField */ "./app/views/eventsV2/table/queryField.tsx");
/* harmony import */ var sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! sentry/views/eventsV2/table/types */ "./app/views/eventsV2/table/types.tsx");
/* harmony import */ var _addButton__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./addButton */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/addButton.tsx");
/* harmony import */ var _deleteButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./deleteButton */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/yAxisSelector/deleteButton.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");




function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }















function YAxisSelector(_ref) {
  var _errors$find;

  let {
    displayType,
    widgetType,
    aggregates,
    tags,
    onChange,
    errors,
    noFieldsMessage
  } = _ref;
  const organization = (0,sentry_utils_useOrganization__WEBPACK_IMPORTED_MODULE_8__["default"])();
  const datasetConfig = (0,sentry_views_dashboardsV2_datasetConfig_base__WEBPACK_IMPORTED_MODULE_9__.getDatasetConfig)(widgetType);
  const {
    customMeasurements
  } = (0,sentry_utils_useCustomMeasurements__WEBPACK_IMPORTED_MODULE_7__["default"])();

  function handleAddOverlay(event) {
    event.preventDefault();
    const newAggregates = [...aggregates, {
      kind: sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__.FieldValueKind.FIELD,
      field: ''
    }];
    onChange(newAggregates);
  }

  function handleAddEquation(event) {
    event.preventDefault();
    const newAggregates = [...aggregates, {
      kind: sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__.FieldValueKind.EQUATION,
      field: ''
    }];
    onChange(newAggregates);
  }

  function handleRemoveQueryField(event, fieldIndex) {
    event.preventDefault();
    const newAggregates = [...aggregates];
    newAggregates.splice(fieldIndex, 1);
    onChange(newAggregates);
  }

  function handleChangeQueryField(value, fieldIndex) {
    const newAggregates = [...aggregates];
    newAggregates[fieldIndex] = value;
    onChange(newAggregates);
  }

  const fieldError = errors === null || errors === void 0 ? void 0 : (_errors$find = errors.find(error => error === null || error === void 0 ? void 0 : error.aggregates)) === null || _errors$find === void 0 ? void 0 : _errors$find.aggregates;
  const canDelete = aggregates.length > 1;
  const hideAddYAxisButtons = [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_10__.DisplayType.WORLD_MAP, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_10__.DisplayType.BIG_NUMBER].includes(displayType) && aggregates.length === 1 || [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_10__.DisplayType.LINE, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_10__.DisplayType.AREA, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_10__.DisplayType.BAR].includes(displayType) && aggregates.length === 3;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)(sentry_components_forms_field__WEBPACK_IMPORTED_MODULE_4__["default"], {
    inline: false,
    flexibleControlStateSize: true,
    error: fieldError,
    stacked: true,
    children: [aggregates.map((fieldValue, i) => {
      var _datasetConfig$filter, _datasetConfig$filter2;

      return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)(QueryFieldWrapper, {
        children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(sentry_views_eventsV2_table_queryField__WEBPACK_IMPORTED_MODULE_11__.QueryField, {
          fieldValue: fieldValue,
          fieldOptions: datasetConfig.getTableFieldOptions(organization, tags, customMeasurements),
          onChange: value => handleChangeQueryField(value, i),
          filterPrimaryOptions: (_datasetConfig$filter = datasetConfig.filterYAxisOptions) === null || _datasetConfig$filter === void 0 ? void 0 : _datasetConfig$filter.call(datasetConfig, displayType),
          filterAggregateParameters: (_datasetConfig$filter2 = datasetConfig.filterYAxisAggregateParams) === null || _datasetConfig$filter2 === void 0 ? void 0 : _datasetConfig$filter2.call(datasetConfig, fieldValue, displayType),
          otherColumns: aggregates,
          noFieldsMessage: noFieldsMessage
        }), aggregates.length > 1 && (canDelete || fieldValue.kind === sentry_views_eventsV2_table_types__WEBPACK_IMPORTED_MODULE_12__.FieldValueKind.EQUATION) && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_deleteButton__WEBPACK_IMPORTED_MODULE_14__.DeleteButton, {
          onDelete: event => handleRemoveQueryField(event, i)
        })]
      }, `${fieldValue}:${i}`);
    }), !hideAddYAxisButtons && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)(Actions, {
      gap: 1,
      children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_addButton__WEBPACK_IMPORTED_MODULE_13__.AddButton, {
        title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_5__.t)('Add Overlay'),
        onAdd: handleAddOverlay
      }), datasetConfig.enableEquations && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_addButton__WEBPACK_IMPORTED_MODULE_13__.AddButton, {
        title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_5__.t)('Add an Equation'),
        onAdd: handleAddEquation
      })]
    })]
  });
}
YAxisSelector.displayName = "YAxisSelector";

const QueryFieldWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "ew36myz1"
} : 0)("display:flex;align-items:center;justify-content:space-between;:not(:last-child){margin-bottom:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_6__["default"])(1), ";}>*+*{margin-left:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_6__["default"])(1), ";}" + ( true ? "" : 0));

const Actions = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_3__["default"],  true ? {
  target: "ew36myz0"
} : 0)( true ? {
  name: "11g6mpt",
  styles: "justify-content:flex-start"
} : 0);

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/footer.tsx":
/*!*********************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/footer.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Footer": () => (/* binding */ Footer)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/components/buttonBar */ "./app/components/buttonBar.tsx");
/* harmony import */ var sentry_components_confirm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/components/confirm */ "./app/components/confirm.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");








function Footer(_ref) {
  let {
    goBackLocation,
    onSave,
    onDelete,
    invalidForm,
    isEditing
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(Wrapper, {
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(Actions, {
      gap: 1,
      children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_1__["default"], {
        to: goBackLocation,
        children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Cancel')
      }), isEditing && onDelete && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_components_confirm__WEBPACK_IMPORTED_MODULE_3__["default"], {
        priority: "danger",
        message: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Are you sure you want to delete this widget?'),
        onConfirm: onDelete,
        children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_1__["default"], {
          priority: "danger",
          children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Delete')
        })
      }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_1__["default"], {
        priority: "primary",
        onClick: onSave,
        disabled: invalidForm,
        title: invalidForm ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Required fields must be filled out') : undefined,
        children: isEditing ? (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Update Widget') : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Add Widget')
      })]
    })
  });
}
Footer.displayName = "Footer";

const Actions = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_2__["default"],  true ? {
  target: "e1golk021"
} : 0)("justify-content:flex-end;max-width:1000px;padding:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(4), " ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(2), ";padding-right:calc(", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(2), " + ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(2), ");@media (min-width: ", p => p.theme.breakpoints.medium, "){padding:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(4), ";padding-right:calc(", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(4), " + ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(2), ");}" + ( true ? "" : 0));

const Wrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "e1golk020"
} : 0)("background:", p => p.theme.background, ";border-top:1px solid ", p => p.theme.gray200, ";" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/header.tsx":
/*!*********************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/header.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Header": () => (/* binding */ Header)
/* harmony export */ });
/* harmony import */ var sentry_components_breadcrumbs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/components/breadcrumbs */ "./app/components/breadcrumbs.tsx");
/* harmony import */ var sentry_components_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/components/button */ "./app/components/button.tsx");
/* harmony import */ var sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/components/buttonBar */ "./app/components/buttonBar.tsx");
/* harmony import */ var sentry_components_editableText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/components/editableText */ "./app/components/editableText.tsx");
/* harmony import */ var sentry_components_featureFeedback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/components/featureFeedback */ "./app/components/featureFeedback/index.tsx");
/* harmony import */ var sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/components/layouts/thirds */ "./app/components/layouts/thirds.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");









function Header(_ref) {
  let {
    title,
    orgSlug,
    goBackLocation,
    dashboardTitle,
    onChangeTitle
  } = _ref;
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_5__.Header, {
    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_5__.HeaderContent, {
      children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_breadcrumbs__WEBPACK_IMPORTED_MODULE_0__["default"], {
        crumbs: [{
          to: `/organizations/${orgSlug}/dashboards/`,
          label: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Dashboards')
        }, {
          to: goBackLocation,
          label: dashboardTitle
        }, {
          label: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Widget Builder')
        }]
      }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_5__.Title, {
        children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_editableText__WEBPACK_IMPORTED_MODULE_3__["default"], {
          "aria-label": (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Widget title'),
          value: title,
          onChange: onChangeTitle,
          errorMessage: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Widget title is required'),
          maxLength: 255
        })
      })]
    }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_5__.HeaderActions, {
      children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(sentry_components_buttonBar__WEBPACK_IMPORTED_MODULE_2__["default"], {
        gap: 1,
        children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_featureFeedback__WEBPACK_IMPORTED_MODULE_4__.FeatureFeedback, {
          featureName: "widget-builder"
        }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(sentry_components_button__WEBPACK_IMPORTED_MODULE_1__["default"], {
          external: true,
          href: "https://docs.sentry.io/product/dashboards/custom-dashboards/#widget-builder",
          children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_6__.t)('Read the docs')
        })]
      })
    })]
  });
}
Header.displayName = "Header";

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/index.tsx":
/*!********************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/index.tsx ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var sentry_components_acl_feature__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/components/acl/feature */ "./app/components/acl/feature.tsx");
/* harmony import */ var sentry_components_alert__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/components/alert */ "./app/components/alert.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_organization__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/styles/organization */ "./app/styles/organization.tsx");
/* harmony import */ var sentry_utils_useOrganization__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/utils/useOrganization */ "./app/utils/useOrganization.tsx");
/* harmony import */ var _widgetBuilder__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./widgetBuilder */ "./app/views/dashboardsV2/widgetBuilder/widgetBuilder.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");








function WidgetBuilderContainer(props) {
  const organization = (0,sentry_utils_useOrganization__WEBPACK_IMPORTED_MODULE_4__["default"])();
  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_components_acl_feature__WEBPACK_IMPORTED_MODULE_0__["default"], {
    features: ['new-widget-builder-experience-design', 'dashboards-edit'],
    organization: organization,
    renderDisabled: () => (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_styles_organization__WEBPACK_IMPORTED_MODULE_3__.PageContent, {
      children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(sentry_components_alert__WEBPACK_IMPORTED_MODULE_1__["default"], {
        type: "warning",
        children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_2__.t)("You don't have access to this feature")
      })
    }),
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_widgetBuilder__WEBPACK_IMPORTED_MODULE_5__["default"], { ...props,
      organization: organization
    })
  });
}

WidgetBuilderContainer.displayName = "WidgetBuilderContainer";
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (WidgetBuilderContainer);

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/widgetBuilder.tsx":
/*!****************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/widgetBuilder.tsx ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DATA_SET_TO_WIDGET_TYPE": () => (/* binding */ DATA_SET_TO_WIDGET_TYPE),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ "../node_modules/core-js/modules/es.array.includes.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ "../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash/cloneDeep */ "../node_modules/lodash/cloneDeep.js");
/* harmony import */ var lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var lodash_isEmpty__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! lodash/isEmpty */ "../node_modules/lodash/isEmpty.js");
/* harmony import */ var lodash_isEmpty__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(lodash_isEmpty__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var lodash_omit__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash/omit */ "../node_modules/lodash/omit.js");
/* harmony import */ var lodash_omit__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash_omit__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var lodash_set__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! lodash/set */ "../node_modules/lodash/set.js");
/* harmony import */ var lodash_set__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(lodash_set__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var sentry_actionCreators_dashboards__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! sentry/actionCreators/dashboards */ "./app/actionCreators/dashboards.tsx");
/* harmony import */ var sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! sentry/actionCreators/indicator */ "./app/actionCreators/indicator.tsx");
/* harmony import */ var sentry_actionCreators_members__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! sentry/actionCreators/members */ "./app/actionCreators/members.tsx");
/* harmony import */ var sentry_actionCreators_tags__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! sentry/actionCreators/tags */ "./app/actionCreators/tags.tsx");
/* harmony import */ var sentry_components_dashboards_widgetQueriesForm__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! sentry/components/dashboards/widgetQueriesForm */ "./app/components/dashboards/widgetQueriesForm.tsx");
/* harmony import */ var sentry_components_datePageFilter__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! sentry/components/datePageFilter */ "./app/components/datePageFilter.tsx");
/* harmony import */ var sentry_components_environmentPageFilter__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! sentry/components/environmentPageFilter */ "./app/components/environmentPageFilter.tsx");
/* harmony import */ var sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! sentry/components/layouts/thirds */ "./app/components/layouts/thirds.tsx");
/* harmony import */ var sentry_components_list__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! sentry/components/list */ "./app/components/list/index.tsx");
/* harmony import */ var sentry_components_list_listItem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! sentry/components/list/listItem */ "./app/components/list/listItem.tsx");
/* harmony import */ var sentry_components_loadingError__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! sentry/components/loadingError */ "./app/components/loadingError.tsx");
/* harmony import */ var sentry_components_organizations_pageFilterBar__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! sentry/components/organizations/pageFilterBar */ "./app/components/organizations/pageFilterBar.tsx");
/* harmony import */ var sentry_components_organizations_pageFilters_container__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! sentry/components/organizations/pageFilters/container */ "./app/components/organizations/pageFilters/container.tsx");
/* harmony import */ var sentry_components_projectPageFilter__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! sentry/components/projectPageFilter */ "./app/components/projectPageFilter.tsx");
/* harmony import */ var sentry_components_sentryDocumentTitle__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! sentry/components/sentryDocumentTitle */ "./app/components/sentryDocumentTitle.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_organization__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! sentry/styles/organization */ "./app/styles/organization.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_utils__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! sentry/utils */ "./app/utils.tsx");
/* harmony import */ var sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! sentry/utils/analytics/trackAdvancedAnalyticsEvent */ "./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx");
/* harmony import */ var sentry_utils_customMeasurements_customMeasurementsProvider__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! sentry/utils/customMeasurements/customMeasurementsProvider */ "./app/utils/customMeasurements/customMeasurementsProvider.tsx");
/* harmony import */ var sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! sentry/utils/discover/fields */ "./app/utils/discover/fields.tsx");
/* harmony import */ var sentry_utils_handleXhrErrorResponse__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! sentry/utils/handleXhrErrorResponse */ "./app/utils/handleXhrErrorResponse.tsx");
/* harmony import */ var sentry_utils_useApi__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! sentry/utils/useApi */ "./app/utils/useApi.tsx");
/* harmony import */ var sentry_utils_withPageFilters__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! sentry/utils/withPageFilters */ "./app/utils/withPageFilters.tsx");
/* harmony import */ var sentry_utils_withTags__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! sentry/utils/withTags */ "./app/utils/withTags.tsx");
/* harmony import */ var sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! sentry/views/dashboardsV2/layoutUtils */ "./app/views/dashboardsV2/layoutUtils.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var sentry_views_dashboardsV2_utils__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! sentry/views/dashboardsV2/utils */ "./app/views/dashboardsV2/utils.tsx");
/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../data */ "./app/views/dashboardsV2/data.tsx");
/* harmony import */ var _datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../datasetConfig/base */ "./app/views/dashboardsV2/datasetConfig/base.tsx");
/* harmony import */ var _widgetCard_dashboardsMEPContext__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../widgetCard/dashboardsMEPContext */ "./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx");
/* harmony import */ var _buildSteps_columnsStep__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./buildSteps/columnsStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/columnsStep/index.tsx");
/* harmony import */ var _buildSteps_dataSetStep__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./buildSteps/dataSetStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/dataSetStep.tsx");
/* harmony import */ var _buildSteps_filterResultsStep__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./buildSteps/filterResultsStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/index.tsx");
/* harmony import */ var _buildSteps_groupByStep__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./buildSteps/groupByStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/groupByStep/index.tsx");
/* harmony import */ var _buildSteps_sortByStep__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./buildSteps/sortByStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/sortByStep/index.tsx");
/* harmony import */ var _buildSteps_visualizationStep__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./buildSteps/visualizationStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/visualizationStep.tsx");
/* harmony import */ var _buildSteps_yAxisStep__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./buildSteps/yAxisStep */ "./app/views/dashboardsV2/widgetBuilder/buildSteps/yAxisStep/index.tsx");
/* harmony import */ var _footer__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./footer */ "./app/views/dashboardsV2/widgetBuilder/footer.tsx");
/* harmony import */ var _header__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./header */ "./app/views/dashboardsV2/widgetBuilder/header.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./utils */ "./app/views/dashboardsV2/widgetBuilder/utils.tsx");
/* harmony import */ var _widgetLibrary__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./widgetLibrary */ "./app/views/dashboardsV2/widgetBuilder/widgetLibrary/index.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");




function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }



















































const WIDGET_TYPE_TO_DATA_SET = {
  [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER]: _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS,
  [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.ISSUE]: _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.ISSUES,
  [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.RELEASE]: _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.RELEASES
};
const DATA_SET_TO_WIDGET_TYPE = {
  [_utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS]: sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
  [_utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.ISSUES]: sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.ISSUE,
  [_utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.RELEASES]: sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.RELEASE
};

function WidgetBuilder(_ref) {
  var _state$selectedDashbo, _state$selectedDashbo2, _state$errors, _state$errors3, _state$errors4, _state$errors5;

  let {
    dashboard,
    params,
    location,
    organization,
    selection,
    start,
    end,
    statsPeriod,
    onSave,
    route,
    router,
    tags
  } = _ref;
  const {
    widgetIndex,
    orgId,
    dashboardId
  } = params;
  const {
    source,
    displayType,
    defaultTitle,
    limit
  } = location.query;
  const defaultWidgetQuery = (0,_utils__WEBPACK_IMPORTED_MODULE_49__.getParsedDefaultWidgetQuery)(location.query.defaultWidgetQuery); // defaultTableColumns can be a single string if location.query only contains
  // 1 value for this key. Ensure it is a string[]

  let {
    defaultTableColumns
  } = location.query;

  if (typeof defaultTableColumns === 'string') {
    defaultTableColumns = [defaultTableColumns];
  } // Feature flag for new widget builder design. This feature is still a work in progress and not yet available internally.


  const widgetBuilderNewDesign = organization.features.includes('new-widget-builder-experience-design');
  const hasReleaseHealthFeature = organization.features.includes('dashboards-releases');
  const filteredDashboardWidgets = dashboard.widgets.filter(_ref2 => {
    let {
      widgetType
    } = _ref2;

    if (widgetType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.RELEASE) {
      return hasReleaseHealthFeature;
    }

    return true;
  });
  const isEditing = (0,sentry_utils__WEBPACK_IMPORTED_MODULE_26__.defined)(widgetIndex);
  const widgetIndexNum = Number(widgetIndex);
  const isValidWidgetIndex = widgetIndexNum >= 0 && widgetIndexNum < filteredDashboardWidgets.length && Number.isInteger(widgetIndexNum);
  const orgSlug = organization.slug; // Construct PageFilters object using statsPeriod/start/end props so we can
  // render widget graph using saved timeframe from Saved/Prebuilt Query

  const pageFilters = statsPeriod ? { ...selection,
    datetime: {
      start: null,
      end: null,
      period: statsPeriod,
      utc: null
    }
  } : start && end ? { ...selection,
    datetime: {
      start,
      end,
      period: null,
      utc: null
    }
  } : selection; // when opening from discover or issues page, the user selects the dashboard in the widget UI

  const notDashboardsOrigin = [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DashboardWidgetSource.DISCOVERV2, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DashboardWidgetSource.ISSUE_DETAILS].includes(source);
  const api = (0,sentry_utils_useApi__WEBPACK_IMPORTED_MODULE_31__["default"])();
  const [isSubmitting, setIsSubmitting] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);
  const [datasetConfig, setDataSetConfig] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)((0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER));
  const [state, setState] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(() => {
    var _ref3;

    const defaultState = {
      title: defaultTitle !== null && defaultTitle !== void 0 ? defaultTitle : (0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('Custom Widget'),
      displayType: (_ref3 = widgetBuilderNewDesign && displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N ? sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.AREA : displayType) !== null && _ref3 !== void 0 ? _ref3 : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE,
      interval: '5m',
      queries: [],
      limit: limit ? Number(limit) : undefined,
      errors: undefined,
      loading: !!notDashboardsOrigin,
      dashboards: [],
      userHasModified: false,
      prebuiltWidgetId: null,
      dataSet: _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS
    };

    if (defaultWidgetQuery) {
      if (widgetBuilderNewDesign) {
        defaultState.queries = [{ ...defaultWidgetQuery,
          orderby: defaultWidgetQuery.orderby || (datasetConfig.getTableSortOptions ? datasetConfig.getTableSortOptions(organization, defaultWidgetQuery)[0].value : '')
        }];
      } else {
        defaultState.queries = [{ ...defaultWidgetQuery
        }];
      }

      if (![sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N].includes(defaultState.displayType) && !((0,_utils__WEBPACK_IMPORTED_MODULE_49__.getIsTimeseriesChart)(defaultState.displayType) && defaultState.queries[0].columns.length)) {
        defaultState.queries[0].orderby = '';
      }
    } else {
      defaultState.queries = [{ ...datasetConfig.defaultWidgetQuery
      }];
    }

    return defaultState;
  });
  const [widgetToBeUpdated, setWidgetToBeUpdated] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null); // For analytics around widget library selection

  const [latestLibrarySelectionTitle, setLatestLibrarySelectionTitle] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);
  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {
    (0,sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__["default"])('dashboards_views.widget_builder.opened', {
      organization,
      new_widget: !isEditing
    });

    if ((0,sentry_utils__WEBPACK_IMPORTED_MODULE_26__.objectIsEmpty)(tags)) {
      (0,sentry_actionCreators_tags__WEBPACK_IMPORTED_MODULE_11__.loadOrganizationTags)(api, organization.slug, { ...selection,
        // Pin the request to 14d to avoid timeouts, see DD-967 for
        // more information
        datetime: {
          period: '14d',
          start: null,
          end: null,
          utc: null
        }
      });
    }

    if (isEditing && isValidWidgetIndex) {
      const widgetFromDashboard = filteredDashboardWidgets[widgetIndexNum];
      let queries;
      let newDisplayType = widgetFromDashboard.displayType;
      let newLimit = widgetFromDashboard.limit;

      if (widgetFromDashboard.displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N) {
        var _widgetFromDashboard$;

        newLimit = _utils__WEBPACK_IMPORTED_MODULE_49__.DEFAULT_RESULTS_LIMIT;
        newDisplayType = sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.AREA;
        queries = (0,_utils__WEBPACK_IMPORTED_MODULE_49__.normalizeQueries)({
          displayType: newDisplayType,
          queries: widgetFromDashboard.queries,
          widgetType: (_widgetFromDashboard$ = widgetFromDashboard.widgetType) !== null && _widgetFromDashboard$ !== void 0 ? _widgetFromDashboard$ : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
          widgetBuilderNewDesign
        }).map(query => ({ ...query,
          // Use the last aggregate because that's where the y-axis is stored
          aggregates: query.aggregates.length ? [query.aggregates[query.aggregates.length - 1]] : []
        }));
      } else {
        var _widgetFromDashboard$2;

        queries = (0,_utils__WEBPACK_IMPORTED_MODULE_49__.normalizeQueries)({
          displayType: newDisplayType,
          queries: widgetFromDashboard.queries,
          widgetType: (_widgetFromDashboard$2 = widgetFromDashboard.widgetType) !== null && _widgetFromDashboard$2 !== void 0 ? _widgetFromDashboard$2 : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
          widgetBuilderNewDesign
        });
      }

      setState({
        title: widgetFromDashboard.title,
        displayType: newDisplayType,
        interval: widgetFromDashboard.interval,
        queries,
        errors: undefined,
        loading: false,
        dashboards: [],
        userHasModified: false,
        dataSet: widgetFromDashboard.widgetType ? WIDGET_TYPE_TO_DATA_SET[widgetFromDashboard.widgetType] : _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS,
        limit: newLimit,
        prebuiltWidgetId: null
      });
      setDataSetConfig((0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(widgetFromDashboard.widgetType));
      setWidgetToBeUpdated(widgetFromDashboard);
    } // This should only run once on mount
    // eslint-disable-next-line react-hooks/exhaustive-deps

  }, []);
  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {
    async function fetchDashboards() {
      const promise = api.requestPromise(`/organizations/${organization.slug}/dashboards/`, {
        method: 'GET',
        query: {
          sort: 'myDashboardsAndRecentlyViewed'
        }
      });

      try {
        const dashboards = await promise;
        setState(prevState => ({ ...prevState,
          dashboards,
          loading: false
        }));
      } catch (error) {
        const errorMessage = (0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('Unable to fetch dashboards');
        (0,sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_9__.addErrorMessage)(errorMessage);
        (0,sentry_utils_handleXhrErrorResponse__WEBPACK_IMPORTED_MODULE_30__["default"])(errorMessage)(error);
        setState(prevState => ({ ...prevState,
          loading: false
        }));
      }
    }

    if (notDashboardsOrigin) {
      fetchDashboards();
    }

    if (widgetBuilderNewDesign) {
      setState(prevState => ({ ...prevState,
        selectedDashboard: {
          label: dashboard.title,
          value: dashboard.id || _utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID
        }
      }));
    }
  }, [api, dashboard.id, dashboard.title, notDashboardsOrigin, organization.slug, source, widgetBuilderNewDesign]);
  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {
    var _selection$projects;

    (0,sentry_actionCreators_members__WEBPACK_IMPORTED_MODULE_10__.fetchOrgMembers)(api, organization.slug, (_selection$projects = selection.projects) === null || _selection$projects === void 0 ? void 0 : _selection$projects.map(String));
  }, [selection.projects, api, organization.slug]);
  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {
    const onUnload = () => {
      if (!isSubmitting && state.userHasModified) {
        return (0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('You have unsaved changes, are you sure you want to leave?');
      }

      return undefined;
    };

    router.setRouteLeaveHook(route, onUnload);
  }, [isSubmitting, state.userHasModified, route, router]);
  const widgetType = state.dataSet === _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS ? sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER : state.dataSet === _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.ISSUES ? sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.ISSUE : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.RELEASE;
  const currentWidget = {
    title: state.title,
    displayType: state.displayType,
    interval: state.interval,
    queries: state.queries,
    limit: state.limit,
    widgetType
  };
  const currentDashboardId = (_state$selectedDashbo = (_state$selectedDashbo2 = state.selectedDashboard) === null || _state$selectedDashbo2 === void 0 ? void 0 : _state$selectedDashbo2.value) !== null && _state$selectedDashbo !== void 0 ? _state$selectedDashbo : dashboardId;
  const queryParamsWithoutSource = lodash_omit__WEBPACK_IMPORTED_MODULE_6___default()(location.query, 'source');
  const previousLocation = {
    pathname: (0,sentry_utils__WEBPACK_IMPORTED_MODULE_26__.defined)(currentDashboardId) && currentDashboardId !== _utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID ? `/organizations/${orgId}/dashboard/${currentDashboardId}/` : `/organizations/${orgId}/dashboards/${_utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID}/`,
    query: lodash_isEmpty__WEBPACK_IMPORTED_MODULE_5___default()(queryParamsWithoutSource) ? undefined : queryParamsWithoutSource
  };
  const isTimeseriesChart = (0,_utils__WEBPACK_IMPORTED_MODULE_49__.getIsTimeseriesChart)(state.displayType);
  const isTabularChart = [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N].includes(state.displayType);

  function updateFieldsAccordingToDisplayType(newDisplayType) {
    setState(prevState => {
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(prevState);

      if (!!!datasetConfig.supportedDisplayTypes.includes(newDisplayType)) {
        // Set to Events dataset if Display Type is not supported by
        // current dataset
        lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'queries', (0,_utils__WEBPACK_IMPORTED_MODULE_49__.normalizeQueries)({
          displayType: newDisplayType,
          queries: [{ ...(0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER).defaultWidgetQuery
          }],
          widgetType: sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
          widgetBuilderNewDesign
        }));
        lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'dataSet', _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS);
        setDataSetConfig((0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER));
        return { ...newState,
          errors: undefined
        };
      }

      const normalized = (0,_utils__WEBPACK_IMPORTED_MODULE_49__.normalizeQueries)({
        displayType: newDisplayType,
        queries: prevState.queries,
        widgetType: DATA_SET_TO_WIDGET_TYPE[prevState.dataSet],
        widgetBuilderNewDesign
      });

      if (newDisplayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N) {
        // TOP N display should only allow a single query
        normalized.splice(1);
      }

      if (!prevState.userHasModified) {
        // Default widget provided by Add to Dashboard from Discover
        if (defaultWidgetQuery && defaultTableColumns) {
          // If switching to Table visualization, use saved query fields for Y-Axis if user has not made query changes
          // This is so the widget can reflect the same columns as the table in Discover without requiring additional user input
          if (newDisplayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE) {
            normalized.forEach(query => {
              var _defaultWidgetQuery$o;

              const tableQuery = (0,sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.getColumnsAndAggregates)(defaultTableColumns);
              query.columns = [...tableQuery.columns];
              query.aggregates = [...tableQuery.aggregates];
              query.fields = [...defaultTableColumns];
              query.orderby = (_defaultWidgetQuery$o = defaultWidgetQuery.orderby) !== null && _defaultWidgetQuery$o !== void 0 ? _defaultWidgetQuery$o : query.fields.length ? `${query.fields[0]}` : '-';
            });
          } else if (newDisplayType === displayType) {
            // When switching back to original display type, default fields back to the fields provided from the discover query
            normalized.forEach(query => {
              query.fields = [...defaultWidgetQuery.columns, ...defaultWidgetQuery.aggregates];
              query.aggregates = [...defaultWidgetQuery.aggregates];
              query.columns = [...defaultWidgetQuery.columns];

              if (!!defaultWidgetQuery.orderby && (displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N || defaultWidgetQuery.columns.length)) {
                query.orderby = defaultWidgetQuery.orderby;
              }
            });
          }
        }
      }

      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'queries', normalized);

      if (widgetBuilderNewDesign) {
        if ((0,_utils__WEBPACK_IMPORTED_MODULE_49__.getIsTimeseriesChart)(newDisplayType) && normalized[0].columns.filter(column => !!column).length) {
          var _prevState$limit;

          // If a limit already exists (i.e. going between timeseries) then keep it,
          // otherwise calculate a limit
          newState.limit = (_prevState$limit = prevState.limit) !== null && _prevState$limit !== void 0 ? _prevState$limit : Math.min((0,_utils__WEBPACK_IMPORTED_MODULE_49__.getResultsLimit)(normalized.length, normalized[0].columns.length), _utils__WEBPACK_IMPORTED_MODULE_49__.DEFAULT_RESULTS_LIMIT);
        } else {
          newState.limit = undefined;
        }
      }

      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
      return { ...newState,
        errors: undefined
      };
    });
  }

  function getUpdateWidgetIndex() {
    if (!widgetToBeUpdated) {
      return -1;
    }

    return dashboard.widgets.findIndex(widget => {
      if ((0,sentry_utils__WEBPACK_IMPORTED_MODULE_26__.defined)(widget.id)) {
        return widget.id === widgetToBeUpdated.id;
      }

      if ((0,sentry_utils__WEBPACK_IMPORTED_MODULE_26__.defined)(widget.tempId)) {
        return widget.tempId === widgetToBeUpdated.tempId;
      }

      return false;
    });
  }

  function handleDisplayTypeOrTitleChange(field, value) {
    (0,sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__["default"])('dashboards_views.widget_builder.change', {
      from: source,
      field,
      value,
      widget_type: widgetType,
      organization,
      new_widget: !isEditing
    });
    setState(prevState => {
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(prevState);
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, field, value);

      if (field === 'title') {
        lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
      }

      return { ...newState,
        errors: undefined
      };
    });

    if (field === 'displayType' && value !== state.displayType) {
      updateFieldsAccordingToDisplayType(value);
    }
  }

  function handleDataSetChange(newDataSet) {
    (0,sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__["default"])('dashboards_views.widget_builder.change', {
      from: source,
      field: 'dataSet',
      value: newDataSet,
      widget_type: widgetType,
      organization,
      new_widget: !isEditing
    });
    setState(prevState => {
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(prevState);
      newState.queries.splice(0, newState.queries.length);
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'dataSet', newDataSet);

      if (newDataSet === _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.ISSUES) {
        lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'displayType', sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE);
      }

      const config = (0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(DATA_SET_TO_WIDGET_TYPE[newDataSet]);
      setDataSetConfig(config);
      newState.queries.push(...(widgetToBeUpdated !== null && widgetToBeUpdated !== void 0 && widgetToBeUpdated.widgetType && WIDGET_TYPE_TO_DATA_SET[widgetToBeUpdated.widgetType] === newDataSet ? widgetToBeUpdated.queries : [{ ...config.defaultWidgetQuery
      }]));
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
      return { ...newState,
        errors: undefined
      };
    });
  }

  function handleAddSearchConditions() {
    setState(prevState => {
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(prevState);
      const config = (0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(DATA_SET_TO_WIDGET_TYPE[prevState.dataSet]);
      const query = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(config.defaultWidgetQuery);
      query.fields = prevState.queries[0].fields;
      query.aggregates = prevState.queries[0].aggregates;
      query.columns = prevState.queries[0].columns;
      query.orderby = prevState.queries[0].orderby;
      newState.queries.push(query);
      return newState;
    });
  }

  function handleQueryRemove(index) {
    setState(prevState => {
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(prevState);
      newState.queries.splice(index, 1);
      return { ...newState,
        errors: undefined
      };
    });
  }

  function handleQueryChange(queryIndex, newQuery) {
    setState(prevState => {
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(prevState);
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, `queries.${queryIndex}`, newQuery);
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
      return { ...newState,
        errors: undefined
      };
    });
  }

  function getHandleColumnFieldChange(isMetricsData) {
    function handleColumnFieldChange(newFields) {
      const fieldStrings = newFields.map(sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.generateFieldAsString);
      const splitFields = (0,sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.getColumnsAndAggregatesAsStrings)(newFields);
      const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(state);
      let newQuery = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(newState.queries[0]);
      newQuery.fields = fieldStrings;
      newQuery.aggregates = splitFields.aggregates;
      newQuery.columns = splitFields.columns;
      newQuery.fieldAliases = splitFields.fieldAliases;

      if (datasetConfig.handleColumnFieldChangeOverride) {
        newQuery = datasetConfig.handleColumnFieldChangeOverride(newQuery);
      }

      if (datasetConfig.handleOrderByReset) {
        // If widget is metric backed, don't default to sorting by transaction unless its the only column
        // Sorting by transaction is not supported in metrics
        if (isMetricsData && fieldStrings.some(fieldString => !['transaction', 'title'].includes(fieldString))) {
          newQuery = datasetConfig.handleOrderByReset(newQuery, fieldStrings.filter(fieldString => !['transaction', 'title'].includes(fieldString)));
        } else {
          newQuery = datasetConfig.handleOrderByReset(newQuery, fieldStrings);
        }
      }

      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'queries', [newQuery]);
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
      setState(newState);
    }

    return handleColumnFieldChange;
  }

  function handleYAxisChange(newFields) {
    const fieldStrings = newFields.map(sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.generateFieldAsString);
    const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(state);
    const newQueries = state.queries.map(query => {
      let newQuery = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(query);

      if (state.displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TOP_N) {
        var _newQuery$fields$slic, _newQuery$fields;

        // Top N queries use n-1 fields for columns and the nth field for y-axis
        newQuery.fields = [...((_newQuery$fields$slic = (_newQuery$fields = newQuery.fields) === null || _newQuery$fields === void 0 ? void 0 : _newQuery$fields.slice(0, newQuery.fields.length - 1)) !== null && _newQuery$fields$slic !== void 0 ? _newQuery$fields$slic : []), ...fieldStrings];
        newQuery.aggregates = [...newQuery.aggregates.slice(0, newQuery.aggregates.length - 1), ...fieldStrings];
      } else {
        newQuery.fields = [...newQuery.columns, ...fieldStrings];
        newQuery.aggregates = fieldStrings;
      }

      if (datasetConfig.handleOrderByReset) {
        newQuery = datasetConfig.handleOrderByReset(newQuery, fieldStrings);
      }

      return newQuery;
    });
    lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'queries', newQueries);
    lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
    const groupByFields = newState.queries[0].columns.filter(field => !(field === 'equation|'));

    if (groupByFields.length === 0) {
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'limit', undefined);
    } else {
      var _newState$limit;

      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'limit', Math.min((_newState$limit = newState.limit) !== null && _newState$limit !== void 0 ? _newState$limit : _utils__WEBPACK_IMPORTED_MODULE_49__.DEFAULT_RESULTS_LIMIT, (0,_utils__WEBPACK_IMPORTED_MODULE_49__.getResultsLimit)(newQueries.length, newQueries[0].aggregates.length)));
    }

    setState(newState);
  }

  function handleGroupByChange(newFields) {
    const fieldStrings = newFields.map(sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.generateFieldAsString);
    const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(state);
    const newQueries = state.queries.map(query => {
      const newQuery = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(query);
      newQuery.columns = fieldStrings;

      if (!fieldStrings.length) {
        // The grouping was cleared, so clear the orderby
        newQuery.orderby = '';
      } else if (!newQuery.orderby) {
        const orderOptions = (0,sentry_components_dashboards_widgetQueriesForm__WEBPACK_IMPORTED_MODULE_12__.generateOrderOptions)({
          widgetType: widgetType !== null && widgetType !== void 0 ? widgetType : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
          widgetBuilderNewDesign,
          columns: query.columns,
          aggregates: query.aggregates
        });
        let orderOption; // If no orderby options are available because of DISABLED_SORTS

        if (!!!orderOptions.length) {
          newQuery.orderby = '';
        } else {
          orderOption = orderOptions[0].value;
          newQuery.orderby = `-${orderOption}`;
        }
      }

      return newQuery;
    });
    lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
    lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'queries', newQueries);
    const groupByFields = newState.queries[0].columns.filter(field => !(field === 'equation|'));

    if (groupByFields.length === 0) {
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'limit', undefined);
    } else {
      var _newState$limit2;

      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'limit', Math.min((_newState$limit2 = newState.limit) !== null && _newState$limit2 !== void 0 ? _newState$limit2 : _utils__WEBPACK_IMPORTED_MODULE_49__.DEFAULT_RESULTS_LIMIT, (0,_utils__WEBPACK_IMPORTED_MODULE_49__.getResultsLimit)(newQueries.length, newQueries[0].aggregates.length)));
    }

    setState(newState);
  }

  function handleLimitChange(newLimit) {
    setState(prevState => ({ ...prevState,
      limit: newLimit
    }));
  }

  function handleSortByChange(newSortBy) {
    const newState = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(state);
    state.queries.forEach((query, index) => {
      const newQuery = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_4___default()(query);
      newQuery.orderby = newSortBy;
      lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, `queries.${index}`, newQuery);
    });
    lodash_set__WEBPACK_IMPORTED_MODULE_7___default()(newState, 'userHasModified', true);
    setState(newState);
  }

  function handleDelete() {
    if (!isEditing) {
      return;
    }

    setIsSubmitting(true);
    let nextWidgetList = [...dashboard.widgets];
    const updateWidgetIndex = getUpdateWidgetIndex();
    nextWidgetList.splice(updateWidgetIndex, 1);
    nextWidgetList = (0,sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__.generateWidgetsAfterCompaction)(nextWidgetList);
    onSave(nextWidgetList);
    router.push(previousLocation);
  }

  async function handleSave() {
    var _widgetData$widgetTyp2;

    const widgetData = (0,sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__.assignTempId)(currentWidget);

    if (widgetToBeUpdated) {
      widgetData.layout = widgetToBeUpdated === null || widgetToBeUpdated === void 0 ? void 0 : widgetToBeUpdated.layout;
    } // Only Table and Top N views need orderby


    if (!widgetBuilderNewDesign && !isTabularChart) {
      widgetData.queries.forEach(query => {
        query.orderby = '';
      });
    }

    if (!widgetBuilderNewDesign) {
      widgetData.queries.forEach(query => lodash_omit__WEBPACK_IMPORTED_MODULE_6___default()(query, 'fieldAliases'));
    } // Only Time Series charts shall have a limit


    if (widgetBuilderNewDesign && !isTimeseriesChart) {
      widgetData.limit = undefined;
    }

    if (!(await dataIsValid(widgetData))) {
      return;
    }

    if (latestLibrarySelectionTitle) {
      // User has selected a widget library in this session
      (0,sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__["default"])('dashboards_views.widget_library.add_widget', {
        organization,
        title: latestLibrarySelectionTitle
      });
    }

    setIsSubmitting(true);

    if (notDashboardsOrigin) {
      submitFromSelectedDashboard(widgetData);
      return;
    }

    if (!!widgetToBeUpdated) {
      var _widgetData$widgetTyp;

      let nextWidgetList = [...dashboard.widgets];
      const updateWidgetIndex = getUpdateWidgetIndex();
      const nextWidgetData = { ...widgetData,
        id: widgetToBeUpdated.id
      }; // Only modify and re-compact if the default height has changed

      if ((0,sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__.getDefaultWidgetHeight)(widgetToBeUpdated.displayType) !== (0,sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__.getDefaultWidgetHeight)(widgetData.displayType)) {
        nextWidgetList[updateWidgetIndex] = (0,sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__.enforceWidgetHeightValues)(nextWidgetData);
        nextWidgetList = (0,sentry_views_dashboardsV2_layoutUtils__WEBPACK_IMPORTED_MODULE_34__.generateWidgetsAfterCompaction)(nextWidgetList);
      } else {
        nextWidgetList[updateWidgetIndex] = nextWidgetData;
      }

      onSave(nextWidgetList);
      (0,sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_9__.addSuccessMessage)((0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('Updated widget.'));
      goToDashboards(dashboardId !== null && dashboardId !== void 0 ? dashboardId : _utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID);
      (0,sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__["default"])('dashboards_views.widget_builder.save', {
        organization,
        data_set: (_widgetData$widgetTyp = widgetData.widgetType) !== null && _widgetData$widgetTyp !== void 0 ? _widgetData$widgetTyp : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
        new_widget: false
      });
      return;
    }

    onSave([...dashboard.widgets, widgetData]);
    (0,sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_9__.addSuccessMessage)((0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('Added widget.'));
    goToDashboards(dashboardId !== null && dashboardId !== void 0 ? dashboardId : _utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID);
    (0,sentry_utils_analytics_trackAdvancedAnalyticsEvent__WEBPACK_IMPORTED_MODULE_27__["default"])('dashboards_views.widget_builder.save', {
      organization,
      data_set: (_widgetData$widgetTyp2 = widgetData.widgetType) !== null && _widgetData$widgetTyp2 !== void 0 ? _widgetData$widgetTyp2 : sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER,
      new_widget: true
    });
  }

  async function dataIsValid(widgetData) {
    if (notDashboardsOrigin) {
      // Validate that a dashboard was selected since api call to /dashboards/widgets/ does not check for dashboard
      if (!state.selectedDashboard || !(state.dashboards.find(_ref4 => {
        var _state$selectedDashbo3, _state$selectedDashbo4;

        let {
          title,
          id
        } = _ref4;
        return title === ((_state$selectedDashbo3 = state.selectedDashboard) === null || _state$selectedDashbo3 === void 0 ? void 0 : _state$selectedDashbo3.label) && id === ((_state$selectedDashbo4 = state.selectedDashboard) === null || _state$selectedDashbo4 === void 0 ? void 0 : _state$selectedDashbo4.value);
      }) || state.selectedDashboard.value === _utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID)) {
        setState({ ...state,
          errors: { ...state.errors,
            dashboard: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('This field may not be blank')
          }
        });
        return false;
      }
    }

    setState({ ...state,
      loading: true
    });

    try {
      await (0,sentry_actionCreators_dashboards__WEBPACK_IMPORTED_MODULE_8__.validateWidget)(api, organization.slug, widgetData);
      return true;
    } catch (error) {
      var _error$responseJSON;

      setState({ ...state,
        loading: false,
        errors: { ...state.errors,
          ...(0,_utils__WEBPACK_IMPORTED_MODULE_49__.mapErrors)((_error$responseJSON = error === null || error === void 0 ? void 0 : error.responseJSON) !== null && _error$responseJSON !== void 0 ? _error$responseJSON : {}, {})
        }
      });
      return false;
    }
  }

  function submitFromSelectedDashboard(widgetData) {
    var _pageFilters$datetime;

    if (!state.selectedDashboard) {
      return;
    }

    const queryData = {
      queryNames: [],
      queryConditions: [],
      queryFields: [...widgetData.queries[0].columns, ...widgetData.queries[0].aggregates],
      queryOrderby: widgetData.queries[0].orderby
    };
    widgetData.queries.forEach(query => {
      queryData.queryNames.push(query.name);
      queryData.queryConditions.push(query.conditions);
    });
    const pathQuery = {
      displayType: widgetData.displayType,
      interval: widgetData.interval,
      title: widgetData.title,
      ...queryData,
      // Propagate page filters
      project: pageFilters.projects,
      environment: pageFilters.environments,
      ...lodash_omit__WEBPACK_IMPORTED_MODULE_6___default()(pageFilters.datetime, 'period'),
      statsPeriod: (_pageFilters$datetime = pageFilters.datetime) === null || _pageFilters$datetime === void 0 ? void 0 : _pageFilters$datetime.period
    };
    (0,sentry_actionCreators_indicator__WEBPACK_IMPORTED_MODULE_9__.addSuccessMessage)((0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('Added widget.'));
    goToDashboards(state.selectedDashboard.value, pathQuery);
  }

  function goToDashboards(id, query) {
    const pathQuery = !lodash_isEmpty__WEBPACK_IMPORTED_MODULE_5___default()(queryParamsWithoutSource) || query ? { ...queryParamsWithoutSource,
      ...query
    } : undefined;

    if (id === _utils__WEBPACK_IMPORTED_MODULE_49__.NEW_DASHBOARD_ID) {
      router.push({
        pathname: `/organizations/${organization.slug}/dashboards/new/`,
        query: pathQuery
      });
      return;
    }

    router.push({
      pathname: `/organizations/${organization.slug}/dashboard/${id}/`,
      query: pathQuery
    });
  }

  function isFormInvalid(isMetricsData) {
    // Block saving if the widget uses custom measurements and is not able to be fulfilled with metrics
    const incompatibleCustomMeasurementWidget = !isMetricsData && (0,sentry_views_dashboardsV2_utils__WEBPACK_IMPORTED_MODULE_36__.isCustomMeasurementWidget)(currentWidget);

    if (incompatibleCustomMeasurementWidget || notDashboardsOrigin && !state.selectedDashboard) {
      return true;
    }

    return false;
  }

  const canAddSearchConditions = [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.LINE, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.AREA, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.BAR].includes(state.displayType) && state.queries.length < 3;
  const hideLegendAlias = [sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.WORLD_MAP, sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.BIG_NUMBER].includes(state.displayType); // Tabular visualizations will always have only one query and that query cannot be deleted,
  // so we will always have the first query available to get data from.

  const {
    columns,
    aggregates,
    fields,
    fieldAliases = []
  } = state.queries[0];
  const explodedColumns = (0,react__WEBPACK_IMPORTED_MODULE_3__.useMemo)(() => {
    return columns.map((field, index) => (0,sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.explodeField)({
      field,
      alias: fieldAliases[index]
    }));
  }, [columns, fieldAliases]);
  const explodedAggregates = (0,react__WEBPACK_IMPORTED_MODULE_3__.useMemo)(() => {
    return aggregates.map((field, index) => (0,sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.explodeField)({
      field,
      alias: fieldAliases[index]
    }));
  }, [aggregates, fieldAliases]);
  const explodedFields = (0,sentry_utils__WEBPACK_IMPORTED_MODULE_26__.defined)(fields) ? fields.map((field, index) => (0,sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.explodeField)({
    field,
    alias: fieldAliases[index]
  })) : [...explodedColumns, ...explodedAggregates];
  const groupByValueSelected = currentWidget.queries.some(query => {
    const noEmptyColumns = query.columns.filter(column => !!column);
    return noEmptyColumns.length > 0;
  }); // The SortBy field shall only be displayed in tabular visualizations or
  // on time-series visualizations when at least one groupBy value is selected

  const displaySortByStep = widgetBuilderNewDesign && isTimeseriesChart && groupByValueSelected || isTabularChart;

  if (isEditing && !isValidWidgetIndex) {
    return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_sentryDocumentTitle__WEBPACK_IMPORTED_MODULE_22__["default"], {
      title: dashboard.title,
      orgSlug: orgSlug,
      children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_styles_organization__WEBPACK_IMPORTED_MODULE_24__.PageContent, {
        children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_loadingError__WEBPACK_IMPORTED_MODULE_18__["default"], {
          message: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_23__.t)('The widget you want to edit was not found.')
        })
      })
    });
  }

  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_sentryDocumentTitle__WEBPACK_IMPORTED_MODULE_22__["default"], {
    title: dashboard.title,
    orgSlug: orgSlug,
    children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_organizations_pageFilters_container__WEBPACK_IMPORTED_MODULE_20__["default"], {
      defaultSelection: {
        datetime: {
          start: null,
          end: null,
          utc: null,
          period: _data__WEBPACK_IMPORTED_MODULE_37__.DEFAULT_STATS_PERIOD
        }
      },
      children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_utils_customMeasurements_customMeasurementsProvider__WEBPACK_IMPORTED_MODULE_28__.CustomMeasurementsProvider, {
        organization: organization,
        selection: selection,
        children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_widgetCard_dashboardsMEPContext__WEBPACK_IMPORTED_MODULE_39__.DashboardsMEPProvider, {
          children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsxs)(PageContentWithoutPadding, {
            children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_header__WEBPACK_IMPORTED_MODULE_48__.Header, {
              orgSlug: orgSlug,
              title: state.title,
              dashboardTitle: dashboard.title,
              goBackLocation: previousLocation,
              onChangeTitle: newTitle => {
                handleDisplayTypeOrTitleChange('title', newTitle);
              }
            }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsxs)(Body, {
              children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsxs)(MainWrapper, {
                children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsxs)(Main, {
                  children: [!!!organization.features.includes('dashboards-top-level-filter') && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsxs)(StyledPageFilterBar, {
                    condensed: true,
                    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_projectPageFilter__WEBPACK_IMPORTED_MODULE_21__["default"], {}), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_environmentPageFilter__WEBPACK_IMPORTED_MODULE_14__["default"], {}), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(sentry_components_datePageFilter__WEBPACK_IMPORTED_MODULE_13__["default"], {
                      alignDropdown: "left"
                    })]
                  }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsxs)(BuildSteps, {
                    symbol: "colored-numeric",
                    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_visualizationStep__WEBPACK_IMPORTED_MODULE_45__.VisualizationStep, {
                      location: location,
                      widget: currentWidget,
                      dashboardFilters: dashboard.filters,
                      organization: organization,
                      pageFilters: pageFilters,
                      displayType: state.displayType,
                      error: (_state$errors = state.errors) === null || _state$errors === void 0 ? void 0 : _state$errors.displayType,
                      onChange: newDisplayType => {
                        handleDisplayTypeOrTitleChange('displayType', newDisplayType);
                      },
                      noDashboardsMEPProvider: true
                    }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_dataSetStep__WEBPACK_IMPORTED_MODULE_41__.DataSetStep, {
                      dataSet: state.dataSet,
                      displayType: state.displayType,
                      onChange: handleDataSetChange,
                      hasReleaseHealthFeature: hasReleaseHealthFeature
                    }), isTabularChart && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_widgetCard_dashboardsMEPContext__WEBPACK_IMPORTED_MODULE_39__.DashboardsMEPConsumer, {
                      children: _ref5 => {
                        var _state$errors2;

                        let {
                          isMetricsData
                        } = _ref5;
                        return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_columnsStep__WEBPACK_IMPORTED_MODULE_40__.ColumnsStep, {
                          dataSet: state.dataSet,
                          queries: state.queries,
                          displayType: state.displayType,
                          widgetType: widgetType,
                          queryErrors: (_state$errors2 = state.errors) === null || _state$errors2 === void 0 ? void 0 : _state$errors2.queries,
                          onQueryChange: handleQueryChange,
                          handleColumnFieldChange: getHandleColumnFieldChange(isMetricsData),
                          explodedFields: explodedFields,
                          tags: tags,
                          organization: organization
                        });
                      }
                    }), ![sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.DisplayType.TABLE].includes(state.displayType) && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_yAxisStep__WEBPACK_IMPORTED_MODULE_46__.YAxisStep, {
                      dataSet: state.dataSet,
                      displayType: state.displayType,
                      widgetType: widgetType,
                      queryErrors: (_state$errors3 = state.errors) === null || _state$errors3 === void 0 ? void 0 : _state$errors3.queries,
                      onYAxisChange: newFields => {
                        handleYAxisChange(newFields);
                      },
                      aggregates: explodedAggregates,
                      tags: tags,
                      organization: organization
                    }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_filterResultsStep__WEBPACK_IMPORTED_MODULE_42__.FilterResultsStep, {
                      queries: state.queries,
                      hideLegendAlias: hideLegendAlias,
                      canAddSearchConditions: canAddSearchConditions,
                      organization: organization,
                      queryErrors: (_state$errors4 = state.errors) === null || _state$errors4 === void 0 ? void 0 : _state$errors4.queries,
                      onAddSearchConditions: handleAddSearchConditions,
                      onQueryChange: handleQueryChange,
                      onQueryRemove: handleQueryRemove,
                      selection: pageFilters,
                      widgetType: widgetType,
                      dashboardFilters: dashboard.filters,
                      location: location
                    }), widgetBuilderNewDesign && isTimeseriesChart && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_groupByStep__WEBPACK_IMPORTED_MODULE_43__.GroupByStep, {
                      columns: columns.filter(field => !(field === 'equation|')).map((field, index) => (0,sentry_utils_discover_fields__WEBPACK_IMPORTED_MODULE_29__.explodeField)({
                        field,
                        alias: fieldAliases[index]
                      })),
                      onGroupByChange: handleGroupByChange,
                      organization: organization,
                      tags: tags,
                      dataSet: state.dataSet
                    }), displaySortByStep && (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_buildSteps_sortByStep__WEBPACK_IMPORTED_MODULE_44__.SortByStep, {
                      limit: state.limit,
                      displayType: state.displayType,
                      queries: state.queries,
                      dataSet: state.dataSet,
                      widgetBuilderNewDesign: widgetBuilderNewDesign,
                      error: (_state$errors5 = state.errors) === null || _state$errors5 === void 0 ? void 0 : _state$errors5.orderby,
                      onSortByChange: handleSortByChange,
                      onLimitChange: handleLimitChange,
                      organization: organization,
                      widgetType: widgetType,
                      tags: tags
                    })]
                  })]
                }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_widgetCard_dashboardsMEPContext__WEBPACK_IMPORTED_MODULE_39__.DashboardsMEPConsumer, {
                  children: _ref6 => {
                    let {
                      isMetricsData
                    } = _ref6;
                    return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_footer__WEBPACK_IMPORTED_MODULE_47__.Footer, {
                      goBackLocation: previousLocation,
                      isEditing: isEditing,
                      onSave: handleSave,
                      onDelete: handleDelete,
                      invalidForm: isFormInvalid(isMetricsData)
                    });
                  }
                })]
              }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(Side, {
                children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_51__.jsx)(_widgetLibrary__WEBPACK_IMPORTED_MODULE_50__.WidgetLibrary, {
                  organization: organization,
                  widgetBuilderNewDesign: widgetBuilderNewDesign,
                  selectedWidgetId: state.userHasModified ? null : state.prebuiltWidgetId,
                  onWidgetSelect: prebuiltWidget => {
                    setLatestLibrarySelectionTitle(prebuiltWidget.title);
                    setDataSetConfig((0,_datasetConfig_base__WEBPACK_IMPORTED_MODULE_38__.getDatasetConfig)(prebuiltWidget.widgetType || sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_35__.WidgetType.DISCOVER));
                    const {
                      id,
                      ...prebuiltWidgetProps
                    } = prebuiltWidget;
                    setState({ ...state,
                      ...prebuiltWidgetProps,
                      dataSet: prebuiltWidget.widgetType ? WIDGET_TYPE_TO_DATA_SET[prebuiltWidget.widgetType] : _utils__WEBPACK_IMPORTED_MODULE_49__.DataSet.EVENTS,
                      userHasModified: false,
                      prebuiltWidgetId: id || null
                    });
                  },
                  bypassOverwriteModal: !state.userHasModified
                })
              })]
            })]
          })
        })
      })
    })
  });
}

WidgetBuilder.displayName = "WidgetBuilder";
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,sentry_utils_withPageFilters__WEBPACK_IMPORTED_MODULE_32__["default"])((0,sentry_utils_withTags__WEBPACK_IMPORTED_MODULE_33__["default"])(WidgetBuilder)));

const PageContentWithoutPadding = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_styles_organization__WEBPACK_IMPORTED_MODULE_24__.PageContent,  true ? {
  target: "e1rwomk16"
} : 0)( true ? {
  name: "1hcx8jb",
  styles: "padding:0"
} : 0);

const StyledPageFilterBar = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_organizations_pageFilterBar__WEBPACK_IMPORTED_MODULE_19__["default"],  true ? {
  target: "e1rwomk15"
} : 0)("margin-bottom:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(2), ";" + ( true ? "" : 0));

const BuildSteps = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_list__WEBPACK_IMPORTED_MODULE_16__["default"],  true ? {
  target: "e1rwomk14"
} : 0)("gap:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), ";max-width:100%;" + ( true ? "" : 0));

const Body = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_15__.Body,  true ? {
  target: "e1rwomk13"
} : 0)("&&{gap:0;padding:0;}grid-template-rows:1fr;@media (min-width: ", p => p.theme.breakpoints.large, "){grid-template-columns:minmax(100px, auto) 400px;}@media (min-width: ", p => p.theme.breakpoints.xlarge, "){grid-template-columns:1fr;}" + ( true ? "" : 0)); // HACK: Since we add 30px of padding to the ListItems
// there is 30px of overlap when the screen is just above 1200px.
// When we're up to 1230px (1200 + 30 to account for the padding)
// we decrease the width of ListItems by 30px


const Main = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_15__.Main,  true ? {
  target: "e1rwomk12"
} : 0)("max-width:1000px;flex:1;padding:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), " ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(2), ";@media (min-width: ", p => p.theme.breakpoints.medium, "){padding:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), ";}@media (max-width: calc(", p => p.theme.breakpoints.large, " + ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), ")){", sentry_components_list_listItem__WEBPACK_IMPORTED_MODULE_17__["default"], "{width:calc(100% - ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), ");}}" + ( true ? "" : 0));

const Side = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])(sentry_components_layouts_thirds__WEBPACK_IMPORTED_MODULE_15__.Side,  true ? {
  target: "e1rwomk11"
} : 0)("padding:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), " ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(2), ";@media (max-width: ", p => p.theme.breakpoints.large, "){border-top:1px solid ", p => p.theme.gray200, ";grid-row:2/2;grid-column:1/-1;max-width:100%;}@media (min-width: ", p => p.theme.breakpoints.large, "){border-left:1px solid ", p => p.theme.gray200, ";padding-right:", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_25__["default"])(4), ";max-width:400px;}" + ( true ? "" : 0));

const MainWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "e1rwomk10"
} : 0)("display:flex;flex-direction:column;@media (max-width: ", p => p.theme.breakpoints.large, "){grid-column:1/-1;}" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetBuilder/widgetLibrary/index.tsx":
/*!**********************************************************************!*\
  !*** ./app/views/dashboardsV2/widgetBuilder/widgetLibrary/index.tsx ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WidgetLibrary": () => (/* binding */ WidgetLibrary)
/* harmony export */ });
/* harmony import */ var _emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/styled/base */ "../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ "../node_modules/core-js/modules/es.array.includes.js");
/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _emotion_react__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @emotion/react */ "../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js");
/* harmony import */ var sentry_actionCreators_modal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! sentry/actionCreators/modal */ "./app/actionCreators/modal.tsx");
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sentry/styles/space */ "./app/styles/space.tsx");
/* harmony import */ var sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! sentry/views/dashboardsV2/types */ "./app/views/dashboardsV2/types.tsx");
/* harmony import */ var sentry_views_dashboardsV2_widgetLibrary_data__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sentry/views/dashboardsV2/widgetLibrary/data */ "./app/views/dashboardsV2/widgetLibrary/data.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils */ "./app/views/dashboardsV2/widgetBuilder/utils.tsx");
/* harmony import */ var _card__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./card */ "./app/views/dashboardsV2/widgetBuilder/widgetLibrary/card.tsx");
/* harmony import */ var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @emotion/react/jsx-runtime */ "../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");



function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }












function WidgetLibrary(_ref) {
  let {
    bypassOverwriteModal,
    onWidgetSelect,
    widgetBuilderNewDesign,
    organization,
    selectedWidgetId
  } = _ref;
  const theme = (0,_emotion_react__WEBPACK_IMPORTED_MODULE_10__.a)();
  let defaultWidgets = (0,sentry_views_dashboardsV2_widgetLibrary_data__WEBPACK_IMPORTED_MODULE_7__.getTopNConvertedDefaultWidgets)();

  if (!!!organization.features.includes('dashboards-releases')) {
    defaultWidgets = defaultWidgets.filter(widget => !!!(widget.widgetType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_6__.WidgetType.RELEASE));
  }

  function getLibrarySelectionHandler(widget, iconColor) {
    return function handleWidgetSelect() {
      if (bypassOverwriteModal) {
        onWidgetSelect(widget);
        return;
      }

      (0,sentry_actionCreators_modal__WEBPACK_IMPORTED_MODULE_3__.openWidgetBuilderOverwriteModal)({
        onConfirm: () => onWidgetSelect(widget),
        widget,
        iconColor
      });
    };
  }

  return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsxs)(react__WEBPACK_IMPORTED_MODULE_2__.Fragment, {
    children: [(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(Header, {
      children: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_4__.t)('Widget Library')
    }), (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(WidgetLibraryWrapper, {
      children: defaultWidgets.map((widget, index) => {
        const iconColor = theme.charts.getColorPalette(defaultWidgets.length - 2)[index];
        const displayType = widgetBuilderNewDesign && widget.displayType === sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_6__.DisplayType.TOP_N ? sentry_views_dashboardsV2_types__WEBPACK_IMPORTED_MODULE_6__.DisplayType.TABLE : widget.displayType;
        const normalizedQueries = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.normalizeQueries)({
          displayType,
          queries: widget.queries,
          widgetBuilderNewDesign,
          widgetType: widget.widgetType
        });
        const newWidget = { ...widget,
          displayType,
          queries: normalizedQueries
        };
        return (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(CardHoverWrapper, {
          selected: selectedWidgetId === widget.id,
          onClick: getLibrarySelectionHandler(newWidget, iconColor),
          children: (0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_card__WEBPACK_IMPORTED_MODULE_9__.Card, {
            widget: newWidget,
            iconColor: iconColor
          })
        }, widget.title);
      })
    })]
  });
}
WidgetLibrary.displayName = "WidgetLibrary";

const WidgetLibraryWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "ess72gf2"
} : 0)( true ? {
  name: "1fttcpj",
  styles: "display:flex;flex-direction:column"
} : 0);

const Header = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('h5',  true ? {
  target: "ess72gf1"
} : 0)("padding-left:calc(", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(2), " - ", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(0.25), ");" + ( true ? "" : 0));

const CardHoverWrapper = /*#__PURE__*/(0,_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__["default"])('div',  true ? {
  target: "ess72gf0"
} : 0)("padding:calc(", (0,sentry_styles_space__WEBPACK_IMPORTED_MODULE_5__["default"])(2), " - 3px);border:1px solid transparent;border-radius:", p => p.theme.borderRadius, ";transition:border-color 0.3s ease;cursor:pointer;&:hover{border-color:", p => p.theme.gray100, ";}", p => p.selected && `border-color: ${p.theme.gray200};`, ";" + ( true ? "" : 0));

/***/ }),

/***/ "./app/views/dashboardsV2/widgetLibrary/data.tsx":
/*!*******************************************************!*\
  !*** ./app/views/dashboardsV2/widgetLibrary/data.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DEFAULT_WIDGETS": () => (/* binding */ DEFAULT_WIDGETS),
/* harmony export */   "getTopNConvertedDefaultWidgets": () => (/* binding */ getTopNConvertedDefaultWidgets)
/* harmony export */ });
/* harmony import */ var sentry_locale__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sentry/locale */ "./app/locale.tsx");
/* harmony import */ var sentry_utils_discover_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sentry/utils/discover/types */ "./app/utils/discover/types.tsx");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../types */ "./app/views/dashboardsV2/types.tsx");



const DEFAULT_WIDGETS = [{
  id: 'duration-distribution',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Duration Distribution'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Compare transaction durations across different percentiles.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.LINE,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'event.type:transaction',
    fields: ['p50(transaction.duration)', 'p75(transaction.duration)', 'p95(transaction.duration)'],
    aggregates: ['p50(transaction.duration)', 'p75(transaction.duration)', 'p95(transaction.duration)'],
    columns: [],
    orderby: ''
  }]
}, {
  id: 'high-throughput-transactions',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('High Throughput Transactions'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Top 5 transactions with the largest volume.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.TOP_N,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'event.type:transaction',
    fields: ['transaction', 'count()'],
    aggregates: ['count()'],
    columns: ['transaction'],
    orderby: '-count()'
  }]
}, {
  id: 'crash-rates-recent-releases',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Crash Rates for Recent Releases'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Percentage of crashed sessions for latest releases.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.LINE,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.RELEASE,
  interval: '5m',
  limit: 8,
  queries: [{
    name: '',
    conditions: '',
    fields: ['crash_rate(session)', 'release'],
    aggregates: ['crash_rate(session)'],
    columns: ['release'],
    orderby: '-release'
  }]
}, {
  id: 'session-health',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Session Health'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Number of abnormal, crashed, errored and healthy sessions.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.TABLE,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.RELEASE,
  interval: '5m',
  queries: [{
    name: '',
    conditions: '',
    fields: ['session.status', 'sum(session)'],
    aggregates: ['sum(session)'],
    columns: ['session.status'],
    orderby: ''
  }]
}, {
  id: 'lcp-country',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('LCP by Country'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Density map showing page load times by country.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.WORLD_MAP,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'has:geo.country_code',
    fields: ['p75(measurements.lcp)'],
    aggregates: ['p75(measurements.lcp)'],
    columns: [],
    orderby: ''
  }]
}, {
  id: 'miserable-users',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Miserable Users'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Unique users who have experienced slow load times.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.BIG_NUMBER,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: '',
    fields: ['count_miserable(user,300)'],
    aggregates: ['count_miserable(user,300)'],
    columns: [],
    orderby: ''
  }]
}, {
  id: 'slow-vs-fast',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Slow vs. Fast Transactions'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Percentage breakdown of transaction durations over and under 300ms.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.BAR,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'event.type:transaction',
    fields: ['equation|(count_if(transaction.duration,greater,300) / count()) * 100', 'equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100'],
    aggregates: ['equation|(count_if(transaction.duration,greater,300) / count()) * 100', 'equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100'],
    columns: [],
    orderby: ''
  }]
}, {
  id: 'issue-for-review',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Issues For Review'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Most recently seen unresolved issues for review.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.TABLE,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.ISSUE,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'is:unresolved is:for_review',
    fields: ['issue', 'assignee', 'events', 'title'],
    aggregates: [],
    columns: ['issue', 'assignee', 'events', 'title'],
    orderby: 'date'
  }]
}, {
  id: 'top-unhandled',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Top Unhandled Error Types'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Most frequently encountered unhandled errors.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.TOP_N,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'error.unhandled:true',
    fields: ['error.type', 'count()'],
    aggregates: ['count()'],
    columns: ['error.type'],
    orderby: '-count()'
  }]
}, {
  id: 'users-affected',
  title: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Users Affected by Errors'),
  description: (0,sentry_locale__WEBPACK_IMPORTED_MODULE_0__.t)('Footprint of unique users affected by errors.'),
  displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.LINE,
  widgetType: _types__WEBPACK_IMPORTED_MODULE_2__.WidgetType.DISCOVER,
  interval: '5m',
  queries: [{
    name: '',
    conditions: 'event.type:error',
    fields: ['count_unique(user)', 'count()'],
    aggregates: ['count_unique(user)', 'count()'],
    columns: [],
    orderby: ''
  }]
}];
function getTopNConvertedDefaultWidgets() {
  return DEFAULT_WIDGETS.map(widget => {
    if (widget.displayType === _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.TOP_N) {
      return { ...widget,
        displayType: _types__WEBPACK_IMPORTED_MODULE_2__.DisplayType.AREA,
        limit: sentry_utils_discover_types__WEBPACK_IMPORTED_MODULE_1__.TOP_N
      };
    }

    return widget;
  });
}

/***/ }),

/***/ "../node_modules/lodash/_baseExtremum.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_baseExtremum.js ***!
  \***********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var isSymbol = __webpack_require__(/*! ./isSymbol */ "../node_modules/lodash/isSymbol.js");

/**
 * The base implementation of methods like `_.max` and `_.min` which accepts a
 * `comparator` to determine the extremum value.
 *
 * @private
 * @param {Array} array The array to iterate over.
 * @param {Function} iteratee The iteratee invoked per iteration.
 * @param {Function} comparator The comparator used to compare values.
 * @returns {*} Returns the extremum value.
 */
function baseExtremum(array, iteratee, comparator) {
  var index = -1,
      length = array.length;

  while (++index < length) {
    var value = array[index],
        current = iteratee(value);

    if (current != null && (computed === undefined
          ? (current === current && !isSymbol(current))
          : comparator(current, computed)
        )) {
      var computed = current,
          result = value;
    }
  }
  return result;
}

module.exports = baseExtremum;


/***/ }),

/***/ "../node_modules/lodash/_baseGt.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/_baseGt.js ***!
  \*****************************************/
/***/ ((module) => {

/**
 * The base implementation of `_.gt` which doesn't coerce arguments.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is greater than `other`,
 *  else `false`.
 */
function baseGt(value, other) {
  return value > other;
}

module.exports = baseGt;


/***/ })

}]);
//# sourceMappingURL=../sourcemaps/app_utils_discover_charts_tsx-app_views_dashboardsV2_widgetBuilder_index_tsx-node_modules_lod-90a90a.231693b908e3081fbc48576a5026761b.js.map